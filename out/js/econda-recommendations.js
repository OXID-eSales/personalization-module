(function(){var d=function(c,b){for(var a=b.exec(c),e=[],g;null!=a;)g=a.index,0!=g&&(c.substring(0,g),e.push(c.substring(0,g)),c=c.slice(g)),e.push(a[0]),c=c.slice(a[0].length),a=b.exec(c);""==!c&&e.push(c);return e},f=function(c,b){for(var a in b)b.hasOwnProperty(a)&&(c[a]=b[a])};EJS=function(c){c="string"==typeof c?{view:c}:c;this.set_options(c);if(c.precompiled)this.template={},this.template.process=c.precompiled,EJS.update(this.name,this);else{if(c.element){if("string"==typeof c.element){var b=
c.element;c.element=document.getElementById(c.element);if(null==c.element)throw b+"does not exist!";}this.text=c.element.value?c.element.value:c.element.innerHTML;this.name=c.element.id;this.type="["}else if(c.url){c.url=EJS.endExt(c.url,this.extMatch);this.name=this.name?this.name:c.url;var b=c.url,a=EJS.get(this.name,this.cache);if(a)return a;if(a==EJS.INVALID_PATH)return null;try{this.text=EJS.request(b+(this.cache?"":"?"+Math.random()))}catch(e){}if(null==this.text)throw{type:"EJS",message:"There is no template at "+
b};}a=new EJS.Compiler(this.text,this.type);a.compile(c,this.name);EJS.update(this.name,this);this.template=a}};EJS.prototype={render:function(c,b){c=c||{};this._extra_helpers=b;var a=new EJS.Helpers(c,b||{});return this.template.process.call(c,c,a)},update:function(c,b){"string"==typeof c&&(c=document.getElementById(c));if(null==b)return _template=this,function(a){EJS.prototype.update.call(_template,c,a)};"string"==typeof b?(params={},params.url=b,_template=this,params.onComplete=function(a){a=eval(a.responseText);
EJS.prototype.update.call(_template,c,a)},EJS.ajax_request(params)):c.innerHTML=this.render(b)},out:function(){return this.template.out},set_options:function(c){this.type=c.type||EJS.type;this.cache=null!=c.cache?c.cache:EJS.cache;this.text=c.text||null;this.name=c.name||null;this.ext=c.ext||EJS.ext;this.extMatch=RegExp(this.ext.replace(/\./,"."))}};EJS.endExt=function(c,b){if(!c)return null;b.lastIndex=0;return c+(b.test(c)?"":this.ext)};EJS.Scanner=function(c,b,a){f(this,{left_delimiter:b+"%",right_delimiter:"%"+
a,double_left:b+"%%",double_right:"%%"+a,left_equal:b+"%=",left_comment:b+"%#"});this.SplitRegexp="["==b?/(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/:RegExp("("+this.double_left+")|(%%"+this.double_right+")|("+this.left_equal+")|("+this.left_comment+")|("+this.left_delimiter+")|("+this.right_delimiter+"\n)|("+this.right_delimiter+")|(\n)");this.source=c;this.stag=null;this.lines=0};EJS.Scanner.to_text=function(c){return null==c||void 0===c?"":c instanceof Date?c.toDateString():c.toString?
c.toString():""};EJS.Scanner.prototype={scan:function(c){scanline=this.scanline;regex=this.SplitRegexp;if(""==!this.source)for(var b=d(this.source,/\n/),a=0;a<b.length;a++)this.scanline(b[a],regex,c)},scanline:function(c,b,a){this.lines++;c=d(c,b);for(b=0;b<c.length;b++){var e=c[b];if(null!=e)try{a(e,this)}catch(g){throw{type:"EJS.Scanner",line:this.lines};}}}};EJS.Buffer=function(c,b){this.line=[];this.script="";this.pre_cmd=c;this.post_cmd=b;for(var a=0;a<this.pre_cmd.length;a++)this.push(c[a])};
EJS.Buffer.prototype={push:function(c){this.line.push(c)},cr:function(){this.script+=this.line.join("; ");this.line=[];this.script+="\n"},close:function(){if(0<this.line.length){for(var c=0;c<this.post_cmd.length;c++)this.push(pre_cmd[c]);this.script+=this.line.join("; ");line=null}}};EJS.Compiler=function(c,b){this.pre_cmd=["var ___ViewO = [];"];this.post_cmd=[];this.source=" ";null!=c&&("string"==typeof c?(c=c.replace(/\r\n/g,"\n"),this.source=c=c.replace(/\r/g,"\n")):c.innerHTML&&(this.source=
c.innerHTML),"string"!=typeof this.source&&(this.source=""));var b=b||"<",a=">";switch(b){case "[":a="]";break;case "<":break;default:throw b+" is not a supported deliminator";}this.scanner=new EJS.Scanner(this.source,b,a);this.out=""};EJS.Compiler.prototype={compile:function(c,b){c=c||{};this.out="";var a=new EJS.Buffer(this.pre_cmd,this.post_cmd),e="",g=function(a){a=a.replace(/\\/g,"\\\\");a=a.replace(/\n/g,"\\n");return a=a.replace(/"/g,'\\"')};this.scanner.scan(function(b,c){if(null==c.stag)switch(b){case "\n":e+=
"\n";a.push('___ViewO.push("'+g(e)+'");');a.cr();e="";break;case c.left_delimiter:case c.left_equal:case c.left_comment:c.stag=b;0<e.length&&a.push('___ViewO.push("'+g(e)+'")');e="";break;case c.double_left:e+=c.left_delimiter;break;default:e+=b}else switch(b){case c.right_delimiter:switch(c.stag){case c.left_delimiter:"\n"==e[e.length-1]?(e=e.substr(0,e.length-1),a.push(e),a.cr()):a.push(e);break;case c.left_equal:a.push("___ViewO.push((EJS.Scanner.to_text("+e+")))")}c.stag=null;e="";break;case c.double_right:e+=
c.right_delimiter;break;default:e+=b}});0<e.length&&a.push('___ViewO.push("'+g(e)+'")');a.close();this.out=a.script+";";var d="/*"+b+"*/this.process = function(_CONTEXT,_VIEW) { try { with(_VIEW) { with (_CONTEXT) {"+this.out+" return ___ViewO.join('');}}}catch(e){e.lineNumber=null;throw e;}};";try{eval(d)}catch(f){if("undefined"!=typeof JSLINT){JSLINT(this.out);for(var i=0;i<JSLINT.errors.length;i++)if(d=JSLINT.errors[i],"Unnecessary semicolon."!=d.reason)throw d.line++,i=Error(),i.lineNumber=d.line,
i.message=d.reason,c.view&&(i.fileName=c.view),i;}else throw f;}}};EJS.config=function(c){EJS.cache=null!=c.cache?c.cache:EJS.cache;EJS.type=null!=c.type?c.type:EJS.type;EJS.ext=null!=c.ext?c.ext:EJS.ext;var b=EJS.templates_directory||{};EJS.templates_directory=b;EJS.get=function(a,e){return!1==e?null:b[a]?b[a]:null};EJS.update=function(a,e){null!=a&&(b[a]=e)};EJS.INVALID_PATH=-1};EJS.config({cache:!0,type:"<",ext:".htm"});EJS.Helpers=function(c,b){this._data=c;this._extras=b;f(this,b)};EJS.Helpers.prototype=
{view:function(c,b,a){a||(a=this._extras);b||(b=this._data);return(new EJS(c)).render(b,a)},to_text:function(c,b){return null==c||void 0===c?b||"":c instanceof Date?c.toDateString():c.toString?c.toString().replace(/\n/g,"<br />").replace(/''/g,"'"):""}};EJS.newRequest=function(){for(var c=[function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=0;b<c.length;b++)try{var a=c[b]();if(null!=a)return a}catch(e){}};
EJS.request=function(c){var b=new EJS.newRequest;b.open("GET",c,!1);try{b.send(null)}catch(a){return null}return 404==b.status||2==b.status||0==b.status&&""==b.responseText?null:b.responseText};EJS.ajax_request=function(c){c.method=c.method?c.method:"GET";var b=new EJS.newRequest;b.onreadystatechange=function(){if(4==b.readyState)c.onComplete(b)};b.open(c.method,c.url);b.send(null)}})();var __extends=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,c){d.__proto__=c}||function(d,c){for(var b in c)c.hasOwnProperty(b)&&(d[b]=c[b])};return function(f,c){function b(){this.constructor=f}d(f,c);f.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}}(),econda;(function(d){var d=d.recengine||(d.recengine={}),f=function(){};f.currentVersion=function(){return"3.0.10"};d.Version=f})(econda||(econda={}));
(function(d){var d=d.util||(d.util={}),f=function(){};f.trim=function(c){this.trim="function"!==typeof String.prototype.trim?function(b){return String(b).replace(/^\s+|\s+$/g,"")}:function(b){return String(b).trim()};return this.trim(c)};f.html=function(c){var b=this;return String(c).replace(/[&<>"'\/]/g,function(a){return b._entityMap[a]})};f.truncate=function(c,b){void 0===b&&(b=null);var b=b?b:{},a=b.maxLength||100,e=!0==b.wordBoundaries,g=b.ellipsis||" ...",d=b.minLength||1,f=a-g.length;c.length>
a?(a=c.substr(0,f),e&&(e=a.lastIndexOf(" ")-1,e>=d&&(a=a.substr(0,e))),a+=g):a=c;return a};f.ucFirst=function(c){return c.charAt(0).toUpperCase()+c.slice(1)};f._entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};d.StringUtils=f})(econda||(econda={}));
(function(d){var d=d.util||(d.util={}),f=function(){};f._useJQuery=function(){return this.useJQueryIfLoaded&&"undefined"!=typeof jQuery};f.update=function(c,b){return this._useJQuery()?jQuery(c).html(b):this._update(c,b)};f.createFragmentFromHtml=function(c){var b=document.createDocumentFragment(),a=document.createElement("div");for(a.innerHTML=c;a.firstChild;)b.appendChild(a.firstChild);return b};f.appendFromHtml=function(c,b){var a=document.createElement("div");for(a.innerHTML=b;a.firstChild;)if("script"===
String(a.firstChild.nodeName).toLowerCase()){var e=a.firstChild.textContent||a.firstChild.innerHTML,g=document.createElement("script");g.type="text/javascript";if(a.children[0].getAttribute("src"))g.src=a.children[0].getAttribute("src");else try{g.appendChild(document.createTextNode(e))}catch(d){g.text=e}c.appendChild(g);a.removeChild(a.firstChild)}else c.appendChild(a.firstChild)};f.empty=function(c){for(c=f.element(c);c.firstChild;)c.removeChild(c.firstChild)};f._update=function(c,b){var a=this.element(c),
e=null;a&&(a.innerHTML=b,this._handleJavascript(a),e=a.innerHTML);return e};f._handleJavascript=function(c){var b,a,e=c.getElementsByTagName("script");if(0<e.length){b=0;for(a=e.length;b<a;b+=1){var g=this._generateScriptNode(e[b].text||e[b].textContent||e[b].innerHTML||"");c.appendChild(g)}}};f._generateScriptNode=function(c){var b=document.createElement("script");b.type="text/javascript";b.appendChild(document.createTextNode(c));return b};f.isDocumentReady=function(){return"complete"===document.readyState||
"interactive"===document.readyState};f.documentReady=function(c){function b(){a||(a=!0,c())}if(f.isDocumentReady())c();else{var a=!1,e=!1,g=document,d=window;if(g.addEventListener)g.addEventListener("DOMContentLoaded",b,!1);else if(g.attachEvent){try{e=null!=window.frameElement}catch(h){}if(g.documentElement&&g.documentElement.doScroll&&!e){var i=function(){if(!a)try{g.documentElement.doScroll("left"),b()}catch(e){setTimeout(i,10)}};i()}g.attachEvent("onreadystatechange",function(){("complete"===
g.readyState||"interactive"===g.readyState)&&b()})}if(d.addEventListener)d.addEventListener("load",b,!1);else if(d.attachEvent)d.attachEvent("onload",b);else{var k=d.onload;d.onload=function(){k&&k(null);b()}}}};f.remove=function(c){(c=this.element(c))&&c.parentNode.removeChild(c)};f.elements=function(c){var b=null;return this._useJQuery()?jQuery(c):(b="string"==typeof c?"#"==c.substr(0,1)?document.getElementById(c.substr(1)):document.getElementById(c):c)?[b]:{length:0}};f.element=function(c){c=this.elements(c);
return 0<c.length?c[0]:null};f.useJQueryIfLoaded=!0;d.DomHelper=f})(econda||(econda={}));
(function(d){var f=d.util||(d.util={}),c=function(a,e,b,c){this.timestamp=null;this.type="info";this.data=this.message=null;this.timestamp=a;this.type=e;this.message=b;this.data=c};c.TYPE_INFO="info";c.TYPE_WARNING="warning";c.TYPE_ERROR="error";var b=function(){this.container=null;this.autoScroll=!0;this.queue=[];this.timeout=null};b.prototype.log=function(a,e){var b=new c(new Date,c.TYPE_INFO,a,e);this.queue.push(b);this.writeQueue()};b.prototype.warn=function(a,e){var b=new c(new Date,c.TYPE_WARNING,
a,e);this.queue.push(b);this.writeQueue()};b.prototype.error=function(a,e){var b=new c(new Date,c.TYPE_ERROR,a,e);this.queue.push(b);this.writeQueue()};b.prototype.writeQueue=function(){var a=d.util.DomHelper.element(this.container);if(null!=a)for(var e=null;e=this.queue.shift();)this.writeItemToContainer(e,a);else if(null==this.timeout){var b=this;setTimeout(function(){b.writeQueue()},250)}};b.prototype.writeItemToContainer=function(a,e){var b=a.timestamp.getMinutes(),b=10>b?"0"+b.toString():b.toString(),
b=[a.timestamp.getHours().toString(),":",b,".",a.timestamp.getSeconds().toString()," - ",a.message],d=document.createElement("p");d.innerHTML=b.join("");d.style.margin="0";d.style.padding="2px";d.style.fontFamily="Fixed, monospace";d.style.fontSize="12px";switch(a.type){case c.TYPE_ERROR:d.style.backgroundColor="#FF9999";break;case c.TYPE_WARNING:d.style.backgroundColor="#FFFF99"}e.appendChild(d);this.autoScroll&&(e.scrollTop=e.scrollHeight)};b.prototype.getContainerElement=function(){var a=null;
return a=this.container instanceof HTMLElement?this.container:document.getElementById(this.container)};f.LogViewer=b})(econda||(econda={}));
(function(d){var d=d.net||(d.net={}),f=function(c){this.hash=this.query=this.path=this.host=this.scheme=this.uri=null;if(c instanceof f)return c;(this.uri=c)&&this.parseUri()};f.prototype.getScheme=function(){return this.scheme?this.scheme.toLowerCase():null};f.prototype.setScheme=function(c){c=(new String(c)).toLocaleLowerCase();null!==this.uri&&(this.uri=this.uri.replace(/^\w*\:/,c+":"));this.resetComponents();this.parseUri()};f.prototype.getHost=function(){return this.host};f.prototype.getPath=
function(){return this.path};f.prototype.getFilename=function(){var c=this.path;return"string"==typeof c&&-1<c.lastIndexOf("/")?c.substr(c.lastIndexOf("/")+1):null};f.prototype.getQuery=function(){return this.query};f.prototype.getHash=function(){return this.hash};f.prototype.parseUri=function(){var c=this.uri.match(/^(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);this.scheme=c[1]||null;this.host=c[2]||null;this.path=c[3]||null;this.query=c[4]||null;this.hash=c[5]||null;return this};
f.prototype.resetComponents=function(){this.hash=this.query=this.path=this.host=this.scheme=null;return this};f.prototype.getParam=function(c){var b=[];"string"===typeof this.query&&(b=this.query.split("&"));for(var a={},e=0;e<b.length;e++){var g=String(b[e]).split("=");a[g[0]]=2<=g.length?g[1]:""}return a[c]||null};f.prototype.appendParams=function(c){var b=this.uri,a=b.lastIndexOf("#"),e=-1<a?b.substring(0,a):b,a=-1<a?b.substr(a):"",b=-1<b.indexOf("?");this.uri=e+(b?"&":"?")+f.concatParams(c)+a;
this.resetComponents();this.parseUri();return this};f.prototype.match=function(c){return this.uri.match(c)};f.prototype.clone=function(){return new f(this.uri)};f.concatParams=function(c){var b=[],a;for(a in c)b.push(a+"="+encodeURIComponent(c[a]));return b.join("&")};f.detectProtocol=function(){return"string"===typeof location.protocol&&"https:"===location.protocol?"https":"http"};f.prototype.toString=function(){return this.uri};f.SCHEME_HTTP="http";f.SCHEME_HTTPS="https";f.SCHEME_FTP="ftp";d.Uri=
f})(econda||(econda={}));"undefined"==typeof window.econdaConfig&&(window.econdaConfig={});
(function(d){var f=function(){};f.setEnabled=function(c){econdaConfig.debug=c;return this};f.getEnabled=function(){return econdaConfig.debug};f.setExceptionsOnError=function(c){econdaConfig.exceptionsOnError=c;return this};f.getExceptionsOnError=function(){return econdaConfig.exceptionsOnError||!1};f.setOutputContainer=function(c){econdaConfig.debugOutputContainer=c;this.logViewerInstance=null;return this};f.error=function(){for(var c=0;c<arguments.length;c++);if(!0!=econdaConfig.debug)return this;
for(var c=[],b=1;b<arguments.length;b++)c.push(arguments[b]);"undefined"!=typeof console&&console.error&&console.error("[ec] "+arguments[0],c);null!=econdaConfig.debugOutputContainer&&(this.setupLogViewer(),this.logViewerInstance.error(arguments[0],c));if(econdaConfig.exceptionsOnError)throw Error(arguments[0]);return this};f.warn=function(){for(var c=0;c<arguments.length;c++);if(!0!=econdaConfig.debug)return this;for(var c=[],b=1;b<arguments.length;b++)c.push(arguments[b]);"undefined"!=typeof console&&
console.warn&&console.warn("[ec] "+arguments[0],c);null!=econdaConfig.debugOutputContainer&&(this.setupLogViewer(),this.logViewerInstance.warn(arguments[0],c));return this};f.log=function(){for(var c=0;c<arguments.length;c++);if(!0!=econdaConfig.debug)return this;for(var c=[],b=1;b<arguments.length;b++)c.push(arguments[b]);"undefined"!=typeof console&&console.log&&(0<c.length?console.log("[ec] "+arguments[0],c):console.log("[ec] "+arguments[0]));null!=econdaConfig.debugOutputContainer&&(this.setupLogViewer(),
this.logViewerInstance.log(arguments[0],c));return this};f.setupLogViewer=function(){null==this.logViewerInstance&&(this.logViewerInstance=new d.util.LogViewer,this.logViewerInstance.container=econdaConfig.debugOutputContainer)};f.logViewerInstance=null;d.debug=f})(econda||(econda={}));
(function(d){var d=d.util||(d.util={}),f=function(){};f.indexOf=function(c,b){if(Array.prototype.indexOf)return c.indexOf(b);for(var a=0;a<c.length;a++)if(c[a]==b)return a;return-1};f.contains=function(c,b){return-1<f.indexOf(c,b)};f.isArray=function(c){this.isArrayFn||(this.isArrayFn="undefined"!=typeof Array.isArray?Array.isArray:function(b){return"[object Array]"===Object.prototype.toString.call(b)});return this.isArrayFn(c)};f.shuffle=function(c){for(var b=c.length,a,e;b;)e=Math.floor(Math.random()*
b--),a=c[b],c[b]=c[e],c[e]=a;return c};f.remove=function(c,b){if("function"===typeof b)return this._removeByFunction(c,b);var a=f.isArray(b)?b:[b];return this._removeItems(c,a)};f._removeItems=function(c,b){for(var a=[],e=0;e<b.length;e++){var g=c.indexOf(b[e]);-1<g&&(a=a.concat(c.splice(g,1)))}return a};f._removeByFunction=function(c,b){for(var a=[],e=0;e<c.length;e++)!0===b(c[e],e,c)&&(a=a.concat(c.splice(e,1)),e--);return a};f.filter=function(c,b){if("function"!==typeof b)return c;if("function"===
typeof c.filter)return c.filter(b);for(var a=[],e=0;e<c.length;e++)!0===b(c[e],e,c)&&a.push(c[e]);return a};f.isArrayFn=null;d.ArrayUtils=f})(econda||(econda={}));
(function(d){var f=d.base||(d.base={}),c=function(){this.__defaultProperty=null};c.prototype.initConfig=function(b,a){void 0===a&&(a=null);null!=a&&(this.__defaultProperty=a);"undefined"!=typeof b&&this.set(b)};c.prototype.set=function(b,a){var e,g;if("object"==typeof b)for(e in b)if(g=this.getSetterName(e),"undefined"!=typeof this[g])this[g](b[e]);else d.debug.error("Cannot set "+e+" in "+this._getClassName()+": no setter defined.");else if("string"==typeof b&&2==arguments.length)if(e=b,g=this.getSetterName(e),
"undefined"!=typeof this[g])this[g](a);else d.debug.error("Cannot set "+e+" in "+this._getClassName()+": no setter defined.");else"undefined"!=typeof b&&this.__defaultProperty&&(g=this.getSetterName(this.__defaultProperty),this[g](b));return this};c.prototype.get=function(b){var a=this.getGetterName(b);if("undefined"!=typeof this[a])return this[a]();d.debug.error("Cannot get "+b+" in "+this._getClassName()+": no getter defined.")};c.prototype._getClassName=function(){try{return this.constructor.name}catch(b){return null}};
c.prototype.getSetterName=function(b){return"set"+b.substr(0,1).toUpperCase()+b.substr(1)};c.prototype.getGetterName=function(b){return"get"+b.substr(0,1).toUpperCase()+b.substr(1)};c.prototype.setArray=function(b,a,e,g){void 0===e&&(e=null);this[b]=[];this.addArray(b,a,e,g);return this};c.prototype.addArray=function(b,a,e,g){void 0===e&&(e=null);if("undefined"===typeof g||null===g)g={};var c=a;!1==d.util.ArrayUtils.isArray(a)&&(c=[a]);for(a=0;a<c.length;a++){var f;f="function"===typeof g.itemFilter?
g.itemFilter.call(this,c[a]):c[a];f=null===e||f instanceof e?f:new e(f);"function"===typeof g.callback&&g.callback.call(this,f);this[b].push(f)}return this};c.prototype.clone=function(){var b=new this.constructor,a;for(a in this)b[a]=this[a];return b};f.BaseClass=c})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.response||(f.response={}),c=d.base.BaseClass,b=function(a){void 0===a&&(a=null);var e=c.call(this)||this;e.emcs=null;e.emcs0=null;e.emcs1=null;if(a instanceof b)return a;a&&e.initConfig(a);return e};__extends(b,c);b.prototype.setEmcs=function(a){this.emcs=a;return this};b.prototype.getEmcs=function(){return this.emcs};b.prototype.getEmcs0=function(){return this.emcs0};b.prototype.setEmcs0=function(a){this.emcs0=a;return this};b.prototype.getEmcs1=
function(){return this.emcs1};b.prototype.setEmcs1=function(a){this.emcs1=a;return this};f.Tracking=b})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),c=f.response||(f.response={}),b=d.base.BaseClass,a=function(e){void 0===e&&(e=null);var g=b.call(this)||this;g._title=null;g._disableOnEmpty=!0;g._tracking=null;g._deeplinkFallbackUrl=null;if(e instanceof a)return e;e&&g.initConfig(e);return g};__extends(a,b);a.prototype.getTitle=function(){return this._title};a.prototype.setTitle=function(a){this._title=a};a.prototype.getDisableOnEmpty=function(){return this._disableOnEmpty};a.prototype.setDisableonempty=
function(a){this._disableOnEmpty=a};a.prototype.setDisableOnEmpty=function(a){this._disableOnEmpty=a};a.prototype.getTracking=function(a){void 0===a&&(a=!1);return a&&null===this._tracking?new c.Tracking:this._tracking};a.prototype.setTracking=function(a){this._tracking=new c.Tracking(a)};a.prototype.setDeeplinkfallbackurl=function(a){this._deeplinkFallbackUrl=a};a.prototype.setDeeplinkFallbackUrl=function(a){this._deeplinkFallbackUrl=a};a.prototype.getDeeplinkFallbackUrl=function(){return this._deeplinkFallbackUrl};
c.WidgetDetails=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.response||(f.response={}),c=d.recengine.response.WidgetDetails,b=d.base.BaseClass,a=function(e){var g=b.call(this)||this;g._isError=!1;g._request=null;g._startIndex=0;g._endIndex=null;g.products=[];g.widgetDetails=null;if(e instanceof a)return e;g.initConfig(e);return g};__extends(a,b);a.prototype.getIsError=function(){return this._isError};a.prototype.setIsError=function(a){this._isError=a;return this};a.prototype.getRequest=function(){return this._request};
a.prototype.setRequest=function(a){this._request=a;return this};a.prototype.getStartIndex=function(){return this._startIndex};a.prototype.setStartIndex=function(a){this._startIndex=a;return this};a.prototype.getEndIndex=function(){return this._endIndex};a.prototype.setEndIndex=function(a){this._endIndex=a;return this};a.prototype.getProducts=function(){return this.products};a.prototype.setProducts=function(a){this.products=a;return this};a.prototype.setWidgetDetails=function(a){this.widgetDetails=
new c(a)};a.prototype.getWidgetDetails=function(a){void 0===a&&(a=!1);return a&&null===this.widgetDetails?new c:this.widgetDetails};f.Response=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.decorator||(f.decorator={}),c=d.base.BaseClass,b=function(){var a=null!==c&&c.apply(this,arguments)||this;a.request=null;a.fields={};a.response=null;return a};__extends(b,c);b.prototype.getRequest=function(){return this.request};b.prototype.setRequest=function(a){this.request=a;return this};b.prototype.getFields=function(){var a=[],e;for(e in this.fields)a.push(e);return this.fields};b.prototype.setFields=function(a){this.fields=d.util.ArrayUtils.isArray(a)?
a:[a];return this};b.prototype.decorate=function(a){this.response=a;for(var a=a.getProducts(),e=0;e<a.length;e++){var b=a[e];this.decorateProduct(b);for(var c=0;c<this.fields.length;c++)"undefined"!=typeof b[this.fields[c]]&&(b[this.fields[c]]=this.decorateField(b[this.fields[c]],b,this.fields[c]))}};b.prototype.decorateProduct=function(){};b.prototype.decorateField=function(){};f.AbstractFieldDecorator=b})(econda||(econda={}));
(function(d){var d=d.util||(d.util={}),f=function(){};f.appendParams=function(c,b){return(0<c.indexOf("?")?c+"&":c+"?")+f.concatParams(b)};f.concatParams=function(c){var b=[],a;for(a in c)b.push(a+"="+encodeURIComponent(c[a]));return b.join("&")};d.UriUtils=f})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.decorator||(f.decorator={}),c=d.util.UriUtils,b=f.AbstractFieldDecorator,a=function(e){void 0===e&&(e=null);var g=b.call(this)||this;g.fields=["deeplink"];g.widgetName=null;g.source=null;g.position=null;if(e instanceof a)return e;g.initConfig(e);return g};__extends(a,b);a.prototype.getWidgetName=function(){return this.widgetName};a.prototype.setWidgetName=function(a){this.widgetName=a;return this};a.prototype.getSource=function(){return this.source};
a.prototype.setSource=function(a){this.source=a;return this};a.prototype.getPosition=function(){return this.position};a.prototype.setPosition=function(a){this.position=a;return this};a.prototype._getTrackingParams=function(a){var b=this.getRequest();return{emcs0:this.getWidgetName()||b.getWidgetId(),emcs1:this.getPosition(),emcs2:this.getSource(),emcs3:a.id}};a.prototype.decorateProduct=function(a){a.trackingparameters=c.concatParams(this._getTrackingParams(a))};a.prototype.decorateField=function(a,
b){return c.appendParams(a,this._getTrackingParams(b))};f.PerformanceTracking=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.decorator||(f.decorator={}),c=d.util.ArrayUtils,b=d.base.BaseClass,a=function(e){void 0===e&&(e=null);var g=b.call(this)||this;g.request=null;if(e instanceof a)return e;g.initConfig(e);return g};__extends(a,b);a.prototype.getRequest=function(){return this.request};a.prototype.setRequest=function(a){this.request=a;return this};a.prototype.decorate=function(a){a=a.getProducts();c.shuffle(a)};f.ProductListRandomizer=a})(econda||(econda={}));
(function(d){var f=d.collection||(d.collection={}),c=d.util.ArrayUtils,b=function(a){this._items=[];this._itemsById={};this._idProperty=null;this.onChange=[];if(a instanceof b)return a;"object"===typeof a&&(this._idProperty=a.idProperty||null,this._items=[],"undefined"!==typeof a.items&&this._setItems(a.items),"undefined"!==typeof a.onChange&&this.setOnChange(a.onChange))};b.prototype.setOnChange=function(a){c.isArray(a)?this.onChange=a:this.onChange=[a]};b.prototype._fireOnChangeEvent=function(a){for(var e=
0;e<this.onChange.length;e++)this.onChange[e](a)};b.prototype.add=function(a){this._items.push(a);null!==this._idProperty&&"undefined"!=typeof a[this._idProperty]&&(this._itemsById[""+a[this._idProperty]]=a);this._collectionChanged();this._fireOnChangeEvent(a);return this};b.prototype.contains=function(a){return c.contains(this._items,a)};b.prototype.length=function(){return this._items.length};b.prototype.sort=function(a){a="string"===typeof a?this._createCompareFunction(a):a;return this._items.sort(a)};
b.prototype._createCompareFunction=function(a){return function(e,b){return e[a]>b[a]?1:e[a]<b[a]?-1:0}};b.prototype.indexOf=function(a){return c.indexOf(this._items,a)};b.prototype.getItemById=function(a){return"undefined"===typeof this._itemsById[""+a]?null:this._itemsById[""+a]};b.prototype.get=function(a){return"undefined"!==typeof this._items[a]?this._items[a]:null};b.prototype.getAll=function(){return this._items};b.prototype.getFilteredItems=function(a){var e=[];if("function"===typeof a.match)for(var b=
0;b<this._items.length;b++)!0===a.match(this._items[b])&&e.push(this._items[b]);else for(b=0;b<this._items.length;b++)!0===a(this._items[b])&&e.push(this._items[b]);return e};b.prototype.forEach=function(a,e){for(var b=0;b<this._items.length;b++)a.call(e,this._items[b])};b.prototype.clear=function(){this._setItems(null);return this};b.prototype._setItems=function(a){this._items=[];this._itemsById={};if(null!==a){if("undefined"!==typeof a.length)this._items=a;else if("object"===typeof a)for(var e in a)a.hasOwnProperty(e)&&
this._items.push(a[e]);if(null!==this._idProperty)for(a=0;a<this._items.length;a++)this._itemsById[""+this._items[a][this._idProperty]]=this._items[a];this._collectionChanged();this.forEach(this._fireOnChangeEvent,this)}};b.prototype._collectionChanged=function(){};f.List=b})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.event||(f.event={}),c=d.base.BaseClass,d=function(){var b=null!==c&&c.apply(this,arguments)||this;b._timestamp=new Date;return b};__extends(d,c);d.prototype.getType=function(){return this.constructor.TYPE};d.prototype.getTimestamp=function(){return this._timestamp};d.prototype.setTimestamp=function(b){this._timestamp=b};d.TYPE=null;f.AbstractEvent=d})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.context||(f.context={}),c=d.base.BaseClass,b=function(a){var e=c.call(this)||this;e._id=null;e._sku=null;if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.getId=function(){return this._id};b.prototype.setId=function(a){this._id=a;return this};b.prototype.getSku=function(){return this._sku};b.prototype.setSku=function(a){this._sku=a;return this};b.prototype.getObjectData=function(){return{className:"econda.recengine.context.ProductReference",
data:{id:this._id,sku:this._sku}}};b.prototype.setObjectData=function(a){"object"===typeof a&&null!==a&&(this._id=a.id||null,this._sku=a.sku||null)};f.ProductReference=b})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.event||(f.event={}),c=d.recengine.context.ProductReference,b=d.recengine.event.AbstractEvent,a=function(e){var g=b.call(this)||this;g._count=1;g._product=null;if(e instanceof a)return e;g.initConfig(e);return g};__extends(a,b);a.prototype.getCount=function(){return this._count};a.prototype.setCount=function(a){this._count=+a};a.prototype.getProduct=function(){return this._product};a.prototype.setProduct=function(a){this._product=new c(a)};a.prototype.getObjectData=
function(){return{className:"econda.recengine.event.ProductAddToCartEvent",data:{timestamp:this.getTimestamp(),count:this._count,product:this._product}}};a.prototype.setObjectData=function(a){"object"===typeof a&&null!==a&&(this.setTimestamp(a.timestamp),this._count=a.count||1,this._product=a.product||null)};a.TYPE="product:add";f.ProductAddToCartEvent=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.event||(f.event={}),c=d.recengine.context.ProductReference,b=d.recengine.event.AbstractEvent,a=function(e){var g=b.call(this)||this;g._count=1;g._product=null;if(e instanceof a)return e;g.initConfig(e);return g};__extends(a,b);a.prototype.getCount=function(){return this._count};a.prototype.setCount=function(a){this._count=+a};a.prototype.getProduct=function(){return this._product};a.prototype.setProduct=function(a){this._product=new c(a)};a.prototype.getObjectData=
function(){return{className:"econda.recengine.event.ProductBuyEvent",data:{timestamp:this.getTimestamp(),count:this._count,product:this._product}}};a.prototype.setObjectData=function(a){"object"===typeof a&&null!==a&&(this.setTimestamp(a.timestamp),this._count=a.count||1,this._product=a.product||null)};a.TYPE="product:buy";f.ProductBuyEvent=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.event||(f.event={}),c=d.recengine.context.ProductReference,b=d.recengine.event.AbstractEvent,a=function(e){var g=b.call(this)||this;g._product=null;if(e instanceof a)return e;g.initConfig(e);return g};__extends(a,b);a.prototype.getProduct=function(){return this._product};a.prototype.setProduct=function(a){this._product=new c(a)};a.prototype.getObjectData=function(){return{className:"econda.recengine.event.ProductViewEvent",data:{timestamp:this.getTimestamp(),
product:this._product}}};a.prototype.setObjectData=function(a){"object"===typeof a&&null!==a&&(this.setTimestamp(a.timestamp),this._product=a.product||null)};a.TYPE="product:view";f.ProductViewEvent=a})(econda||(econda={}));
(function(d){var f=d.cookie||(d.cookie={}),c=d.base.BaseClass,b=function(a){var e=c.call(this)||this;e._name="";e._value="";e._domain="";e._path="/";e._expires=null;e._secure=!1;if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.getName=function(){return this._name};b.prototype.setName=function(a){this._name=a;return this};b.prototype.getValue=function(){return this._value};b.prototype.setValue=function(a){this._value=a;return this};b.prototype.getDomain=function(){return this._domain};
b.prototype.setDomain=function(a){this._domain=a;return this};b.prototype.getPath=function(){return this._path};b.prototype.setPath=function(a){this._path=a;return this};b.prototype.getExpires=function(){return this._expires};b.prototype.setExpires=function(a){var e;"number"==typeof a?(e=new Date,e.setDate(e.getDate()+a)):e=a;this._expires=e;return this};b.prototype.getSecure=function(){return this._secure};b.prototype.setSecure=function(a){this._secure=a;return this};f.Cookie=b})(econda||(econda=
{}));
(function(d){var f=d.cookie||(d.cookie={}),c=function(){};c.contains=function(b){return"undefined"===typeof document.cookie?!1:RegExp("(?:;\\s*|^)"+encodeURIComponent(b)+"=").test(document.cookie)};c.find=function(b){if("undefined"===typeof document.cookie)return{};for(var a=document.cookie.split(";"),e,g={},c=0,d=a.length;c<d;++c){e=a[c].split("=");var f=e[0].replace(/^\s+|\s+$/,"");e=e.slice(1).join("=");if(!1==b instanceof RegExp||b.test(f))g[decodeURIComponent(f)]=decodeURIComponent(e)}return g};c.getValue=
function(b){return d.cookie.Store.contains(b)?d.cookie.Store.find(b)[b]:null};c.set=function(b,a){void 0===a&&(a=!0);if("undefined"===typeof document.cookie)return this;var e=new d.cookie.Cookie(b),g=e.getName(),c=e.getValue(),f=e.getPath(),i=e.getDomain(),k=e.getExpires(),e=e.getSecure(),g=[encodeURIComponent(g)+"="+(a?encodeURIComponent(c):c)];f&&g.push("path="+f);i&&g.push("domain="+i);k&&g.push("expires="+k.toUTCString());e&&g.push("secure");document.cookie=g.join(";");return this};c.remove=function(b){if("undefined"===
typeof document.cookie)return this;var a;a="string"===typeof b?new d.cookie.Cookie({name:b}):new d.cookie.Cookie(b);var e=a.getName(),b=a.getPath(),g=a.getDomain();a=a.getSecure();e=[encodeURIComponent(e)+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"];b&&e.push("path="+b);g&&e.push("domain="+g);a&&e.push("secure");document.cookie=e.join(";");return this};f.Store=c})(econda||(econda={}));
(function(d){var f=d.tracking||(d.tracking={}),c=d.cookie.Store,d=function(b){this.globalConfigProperties=b;for(var a in b)this[a]=b[a]};d.prototype.getPidIndex=function(){return this.PRODUCT_ID_IN_EC_EVENT};d.prototype.getClientCookieLifetime=function(){return this.CLIENT_COOKIE_LIFETIME};d.prototype.getCookieDomain=function(){return this.globalConfigProperties.COOKIE_DOMAIN||this.getDefaultCookieDomainFor(window.location.hostname)};d.prototype.getDefaultCookieDomainFor=function(b){var a=b.split("."),
e=a[a.length-1],g=a[a.length-2],g="uk"==e||"tr"==e||"br"==e||"at"==e&&"co"==g||"jp"==e&&("co"==g||"ac"==g||"go"==g||"ne"==g||"or"==g)?3:2;if(isNaN(parseInt(e,10))&&a.length>=g){b="";for(e=a.length-g;e<a.length;e++)b+="."+a[e]}return b};d.prototype.doNotTrack=function(){return window.emosDoNotTrack||this.DO_NOT_TRACK||this.COOKIE_DNT&&"1"===c.getValue(this.COOKIE_DNT)?!0:!1};d.prototype.isTrackThirdParty=function(){return"undefined"==typeof this.TRACK_THIRD_PARTY||!0==this.TRACK_THIRD_PARTY};d.prototype.isSyncCacheId=
function(){return!0==this.JSID};f.EmosConfig=d})(econda||(econda={}));
(function(d){var f=d.tracking||(d.tracking={}),c=d.tracking.EmosConfig,b=function(){};b.registerPlugin=function(a){-1===b._plugins.indexOf(a)&&b._plugins.push(a)};b.unregisterPlugin=function(a){"function"===typeof a?this.removeAllPlugInsOfType(a):this.removePlugInByInstance(a)};b.removeAllPlugInsOfType=function(a){for(var e=0;e<this._plugins.length;e++)this._plugins[e]instanceof a&&this._plugins.splice(e--,1)};b.removePlugInByInstance=function(a){for(var e=0;e<this._plugins.length;e++)this._plugins[e]===
a&&this._plugins.splice(e,1)};b.clearAll=function(){b._plugins=[]};b.getRegisteredPlugins=function(){return b._plugins};b.handleTrackingRequestEvent=function(a,e,g){void 0===a&&(a={});void 0===g&&(g={});var d=new c(e);if("object"!=typeof g.cb||null===g.cb)g.cb=[];g.cb.push(function(){b.handleTrackingAfterRequestCallback(a,d,g)});for(e=0;e<b._plugins.length;e++){var f=b._plugins[e];if("function"===typeof f.onRequest)f.onRequest(a,d,g)}};b.handleTrackingAfterRequestCallback=function(a,e,g){void 0===
a&&(a={});void 0===g&&(g={});for(var c=0;c<b._plugins.length;c++){var d=b._plugins[c];if("function"===typeof d.onAfterRequest)d.onAfterRequest(a,e,g)}};b.registerManager=function(){var a=window.emos3;if("object"!==typeof a||null===a)a=window.emos3={};if("object"!==typeof a.plugins||null===a.plugins)a.plugins=[];for(var e=0;e<a.plugins.length;e++)if(a.plugins[e]===b.handleTrackingRequestEvent)return;a.plugins.push(b.handleTrackingRequestEvent)};b._plugins=[];f.PluginManager=b;d.tracking.PluginManager.registerManager()})(econda||
(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.history||(f.history={}),c=d.tracking.PluginManager,b=function(){};b.getInstance=function(){null===b._instance&&(b._instance=new b);return b._instance};b.prototype.onRequest=function(a,e){for(var b=this.createEventsFromTrackingData(a,e.getPidIndex()),c=0;c<b.length;c++)d.data.visitor.getHistory().add(b[c]);d.util.ArrayUtils.isArray(a.arpprops)&&this.storeArpProps(a.arpprops)};b.prototype.storeArpProps=function(a){for(var e=0;e<a.length;e++){var b=a[e];
d.data.visitor.setCustomProperty(b[0],b[1])}};b.prototype.createEventsFromTrackingData=function(a,e){var b=[];if("object"===typeof a.ec_Event)for(var c=0;c<a.ec_Event.length;c++){var d=this.createEventFromEcEventItem(a.ec_Event[c],e);d&&b.push(d)}return b};b.prototype.createEventFromEcEventItem=function(a,e){var b=function(a,e){void 0===e&&(e=null);var b=null;switch(String(a).toLowerCase()){case "view":b=new d.recengine.event.ProductViewEvent(e);break;case "c_add":b=new d.recengine.event.ProductAddToCartEvent(e);
break;case "buy":b=new d.recengine.event.ProductBuyEvent(e)}return b},c=null;"undefined"!==typeof a.type?c=b(a.type,{product:{id:a.pid||null,sku:a.sku||null}}):"undefined"!==typeof a[1]&&(c=b(a[0],{product:{id:a[e],sku:null}}));return c};b.enable=function(){c.registerPlugin(b.getInstance())};b.disable=function(){c.unregisterPlugin(b.getInstance())};b._instance=null;f.TrackingListener=b;("undefined"===typeof econdaConfig.crosssellTrackEvents||!0==econdaConfig.crosssellTrackEvents)&&b.enable()})(econda||
(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.history||(f.history={}),c=d.collection.List,d=function(){var b=null!==c&&c.apply(this,arguments)||this;b._maxLength=30;return b};__extends(d,c);d.prototype.getMaxLength=function(){return this._maxLength};d.prototype.setMaxLength=function(b){this._maxLength=+b};d.prototype.cleanup=function(){this.sort("timestamp");this._items.length>this._maxLength&&this._items.splice(0,this._items.length-this._maxLength)};d.prototype.getObjectData=function(){return{className:"econda.recengine.history.VisitorHistory",
data:{items:this._items}}};d.prototype.setObjectData=function(b){"object"===typeof b&&null!==b&&"undefined"!==typeof b.items&&(this._items=b.items)};d.prototype._collectionChanged=function(){this.cleanup()};f.VisitorHistory=d})(econda||(econda={}));
(function(d){var d=d.env||(d.env={}),f=function(){};f.prototype.isAvailable=function(){if("undefined"!=typeof this.storage()&&"function"==typeof this.storage().getItem){try{this.storage().setItem("isAvailableTest","someValue"),this.storage().removeItem("isAvailableTest")}catch(c){if(c.message&&-1<c.message.toLowerCase().indexOf("quota"))return!1}return!0}return!1};f.prototype.setItem=function(c,b){this.isAvailable()&&this.storage().setItem(c,b)};f.prototype.getItem=function(c){return this.isAvailable()?
this.storage().getItem(c):null};f.prototype.removeItem=function(c){this.isAvailable()&&this.storage().removeItem(c)};d.AbstractStorage=f})(econda||(econda={}));
(function(d){var f=d.env||(d.env={}),c=d.env.AbstractStorage,b=function(){return null!==c&&c.apply(this,arguments)||this};__extends(b,c);b.prototype.storage=function(){return window.sessionStorage};b.isAvailable=function(){return(new b).isAvailable()};b.setItem=function(a,e){(new b).setItem(a,e)};b.getItem=function(a){return(new b).getItem(a)};b.removeItem=function(a){(new b).removeItem(a)};f.SessionStorage=b})(econda||(econda={}));
(function(d){var f=d.env||(d.env={}),c=d.env.AbstractStorage,b=function(){return null!==c&&c.apply(this,arguments)||this};__extends(b,c);b.prototype.storage=function(){return window.localStorage};b.isAvailable=function(){return(new b).isAvailable()};b.setItem=function(a,e){(new b).setItem(a,e)};b.getItem=function(a){return(new b).getItem(a)};b.removeItem=function(a){(new b).removeItem(a)};f.LocalStorage=b})(econda||(econda={}));
(function(d){(function(d){var c=function(){function b(){}b.stringify=function(a){b.stringify="undefined"!=typeof JSON&&JSON.stringify?JSON.stringify:b._stringify;return b.stringify(a)};b._stringify=function(a){var e=typeof a,b,c=[],d=a&&a.constructor==Array;if("object"!=e||null===a)return"string"==e&&(a='"'+a+'"'),String(a);for(var f in a)b=a[f],e=typeof b,"string"==e?b='"'+b+'"':"object"==e&&null!==b&&(b=this.stringify(b)),c.push((d?"":'"'+f+'":')+String(b));return(d?"[":"{")+String(c)+(d?"]":"}")};
b.parse=function(a){b.parse="undefined"!=typeof JSON&&JSON.parse?JSON.parse:b._parse;return b.parse(a)};b._parse=function(a){var e=b.cx,a=String(a);e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return a=eval("("+a+")");throw new SyntaxError("JSON.parse");
};b.cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;return b}();d.Json=c})(d.util||(d.util={}))})(econda||(econda={}));
(function(d){(function(f){var c=function(){function b(){}b.serialize=function(a){return(new b).serialize(a)};b.deserialize=function(a,e){void 0===e&&(e=null);return(new b).deserialize(a,e)};b.prototype.serialize=function(a){a=this._serializeNestedObjects(a);return d.util.Json.stringify(a)};b.prototype._serializeNestedObjects=function(a){var e;if(d.util.ArrayUtils.isArray(a)){e=[];for(var b=0;b<a.length;b++)e[b]=this._serializeNestedObjects(a[b]);return e}if("object"===typeof a&&null!==a){if("undefined"!==
typeof a.getObjectData)e=a.getObjectData(),e["$serialized-object$"]=!0,e.data=this._serializeNestedObjects(e.data||null);else if(a instanceof Date)e={className:"Date","$serialized-object$":!0,data:a.toISOString()};else for(b in e={},a)e[b]=this._serializeNestedObjects(a[b]);return e}return a};b.prototype.deserialize=function(a,e){void 0===e&&(e=null);if(!a)return e||null;var b=d.util.Json.parse(a);null!==e?(this._applyData(b.data,e),b=e):b=this._resolveNestedSerializedObjects(b);return b};b.prototype._applyData=
function(a,e){if("function"!==typeof e.setObjectData)throw"setObjectData() not implemented. Cannot deserialize object";a=this._resolveNestedSerializedObjects(a);e.setObjectData(a)};b.prototype._resolveNestedSerializedObjects=function(a){if(d.util.ArrayUtils.isArray(a))for(var e=0;e<a.length;e++)a[e]=this._resolveNestedSerializedObjects(a[e]);else if("object"===typeof a&&null!==a)if("undefined"!==typeof a["$serialized-object$"])a=this._deserializeNestedObject(a);else for(e in a)a[e]=this._resolveNestedSerializedObjects(a[e]);
return a};b.prototype._deserializeNestedObject=function(a){var e;if("Date"===a.className)e=new Date(a.data);else try{e=eval("new "+a.className+"();"),"undefined"!==typeof a.data&&this._applyData(a.data,e)}catch(b){d.debug.error("deserialization faild with exception:",b)}return e};return b}();f.JsonSerializer=c})(d.serialization||(d.serialization={}))})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.visitor||(f.visitor={}),c=d.env.LocalStorage,b=d.base.BaseClass,a=function(e){var c=b.call(this)||this;c._ids={};c._properties={};c._loginState=null;c._history=null;c._isInTransaction=!1;c._triggerSaveTimeout=null;if(e instanceof a)return e;c.initConfig(e);return c};__extends(a,b);a.prototype.setId=function(a,b){void 0===b&&(b=null);if("string"===typeof a)this._ids[a]=b;else for(var c in a)this._ids[c]=a[c];this._triggerSaveIfNotInTransaction();
return this};a.prototype.setIds=function(a,b){void 0===b&&(b=null);this.setId(a,b)};a.prototype.getId=function(a){return this._ids[a]||null};a.prototype.getIds=function(){return this._ids};a.prototype.clearIds=function(){this._ids={};this._triggerSaveIfNotInTransaction()};a.prototype.getProperty=function(a){return this._properties[a]||null};a.prototype.setProperty=function(a,b){if("string"===typeof a)this._properties[a]=b;else if("object"===typeof a&&null!==a)for(var c in a)this._properties[c]=a[c];
this._triggerSaveIfNotInTransaction()};a.prototype.getProperties=function(a){return"string"===typeof a?this._properties[a]||null:this._properties};a.prototype.setProperties=function(a,b){void 0===b&&(b=null);this.setProperty(a,b)};a.prototype.clearProperties=function(){this._properties={};this._triggerSaveIfNotInTransaction()};a.prototype.setLoginState=function(a){this._loginState=a;this._triggerSaveIfNotInTransaction()};a.prototype.getLoginState=function(){return this._loginState};a.prototype.getHistory=
function(){return this._history};a.prototype.setHistory=function(a){var b=this;this._history=a;this._triggerSaveIfNotInTransaction();null!==this._history&&this._history.setOnChange(function(){return b._triggerSaveIfNotInTransaction()})};a.prototype.beginTransaction=function(){this._isInTransaction=!0};a.prototype.commitTransaction=function(){this._isInTransaction=!1;this.saveInBrowser()};a.prototype._triggerSaveIfNotInTransaction=function(){this._isInTransaction||this._triggerSaveInBrowser()};a.prototype._triggerSaveInBrowser=
function(){var a=this;null!==this._triggerSaveTimeout&&clearTimeout(this._triggerSaveTimeout);this._triggerSaveTimeout=setTimeout(function(){a.saveInBrowser()},50)};a.prototype.saveInBrowser=function(){null!==this._triggerSaveTimeout&&clearTimeout(this._triggerSaveTimeout);var b=new d.serialization.JsonSerializer;c.setItem(a.STORAGE_KEY,b.serialize(this))};a.prototype.loadFromBrowser=function(){null!==this._triggerSaveTimeout&&clearTimeout(this._triggerSaveTimeout);var b=new d.serialization.JsonSerializer,
g=c.getItem(a.STORAGE_KEY);g&&b.deserialize(g,this)};a.prototype.getObjectData=function(){return{className:"econda.recengine.visitor.VisitorData",data:{ids:this._ids,properties:this._properties,loginState:this._loginState,history:this._history}}};a.prototype.setObjectData=function(a){"object"===typeof a&&null!==a&&("object"===typeof a.properties&&null!==a.properties&&(this._properties=a.properties),"object"===typeof a.ids&&null!==a.ids&&(this._ids=a.ids),"undefined"!==typeof a.loginState&&(this._loginState=
a.loginState),"undefined"!==typeof a.history&&this.setHistory(a.history))};a.STORAGE_KEY="econda.recengine.VisitorData";f.VisitorData=a})(econda||(econda={}));
(function(d){var f=d.tracking||(d.tracking={}),c=d.cookie.Store,b=d.util.StringUtils,a=function(){};a.get=function(){var a=c.getValue("emos_jcvid");return null!==a?a.split(":",2)[0]:null};a.update=function(a,g){void 0===g&&(g={});var f=function(a,b){for(var e in g)if(!1==b||"expires"!=e)a[e]=g[e];return a};if("string"!==typeof a)d.debug.error("Invalid visitor id given in VisitorId::update().");else{var a=b.trim(a),h=window.emos3;"object"===typeof h&&(h.emos_vid=a);h=c.getValue("emos_jcvid");h="string"===
typeof h&&-1!==h.indexOf(":")?a+h.substring(h.indexOf(":")):a;c.set(f({name:"emos_jcvid",value:h},!1),!1)}};f.VisitorId=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),c=d.recengine.history.VisitorHistory,b=d.recengine.visitor.VisitorData,a=d.util.ArrayUtils,e=d.tracking.VisitorId,g=d.env.SessionStorage,j=d.base.BaseClass,h=function(a){void 0===a&&(a=null);var b=j.call(this)||this;b._persistentData=null;b.initConfig(a);b._initPersistentData();null===g.getItem("econda.recengine.VisitorProfile.initialized")&&b._onFirstInitOfSession();g.setItem("econda.recengine.VisitorProfile.initialized",(new Date).toString());b._initRecipientId();
return b};__extends(h,j);h.prototype.beginTransaction=function(){this._persistentData.beginTransaction()};h.prototype.commitTransaction=function(){this._persistentData.commitTransaction()};h.prototype.getVisitorId=function(){return e.get()};h.prototype.getRecipientId=function(){return this._persistentData.getId("recipientId")};h.prototype.setRecipientId=function(a){this._persistentData.setId("recipientId",a)};h.prototype.getCustomerId=function(){return this._persistentData.getId("customerId")};h.prototype.setCustomerId=
function(a){this._persistentData.setId("customerId",a)};h.prototype.getUserId=function(){return this._persistentData.getId("userId")};h.prototype.setUserId=function(a){this._persistentData.setId("userId",a)};h.prototype.getEmail=function(){return this._persistentData.getId("email")};h.prototype.setEmail=function(a){this._persistentData.setId("email",a)};h.prototype.getEmailHash=function(){return this._persistentData.getId("emailHash")};h.prototype.setEmailHash=function(a){this._persistentData.setId("emailHash",
a)};h.prototype.hasIds=function(){if(this.getVisitorId())return!0;var a=this._persistentData.getIds();return a&&0<Object.keys(a).length?!0:!1};h.prototype.getLoginState=function(){return this._persistentData.getLoginState()||h.LOGIN_STATE_UNKNOWN};h.prototype.setLoginState=function(b){a.contains([h.LOGIN_STATE_PREVIOUS_SESSION,h.LOGIN_STATE_SIGNED_IN,h.LOGIN_STATE_SIGNED_OUT,h.LOGIN_STATE_UNKNOWN],b)||d.debug.error("Invalid login state: "+b);this._persistentData.setLoginState(b)};h.prototype.login=
function(a){void 0===a&&(a=null);this._persistentData.setLoginState(h.LOGIN_STATE_SIGNED_IN);a=a||{};"object"===typeof a.ids&&null!==a.ids&&this._persistentData.setIds({customerId:a.ids.customerId||null,userId:a.ids.userId||null,email:a.ids.email||null,emailHash:a.ids.emailHash||null});this._persistentData.clearProperties();"object"===typeof a.properties&&null!==a.properties&&this.setProperties(a.properties);return this};h.prototype.logout=function(){this._persistentData.setLoginState(h.LOGIN_STATE_SIGNED_OUT);
this.clearAll();return this};h.prototype.clearAll=function(){this._persistentData.clearIds();this._persistentData.clearProperties();return this};h.prototype.getProperties=function(){return this._persistentData.getProperties()};h.prototype.setProperties=function(a){this._persistentData.setProperties(a)};h.prototype.setProperty=function(a,b){this._persistentData.setProperty(a,b)};h.prototype.getProperty=function(a){return this._persistentData.getProperty(a)};h.prototype.setCustomProperty=function(a,
b){this.setProperty(h.CUSTOM_PROFILE_PROPERTIES_PREFIX+a,b)};h.prototype.getCustomProperty=function(a){return this.getProperty(h.CUSTOM_PROFILE_PROPERTIES_PREFIX+a)};h.prototype.getVisitorHistory=function(){return this.getHistory()};h.prototype.getHistory=function(){return this._persistentData.getHistory()};h.prototype._onFirstInitOfSession=function(){this.setRecipientId(null);this.getLoginState()===h.LOGIN_STATE_SIGNED_IN&&this.setLoginState(h.LOGIN_STATE_PREVIOUS_SESSION);return this};h.prototype._initRecipientId=
function(){var a=(new d.net.Uri(window.location.href)).getParam("ecmUid");a&&this.setRecipientId(a);return this};h.prototype._initPersistentData=function(){this._persistentData=new b;this._persistentData.loadFromBrowser();!1===this.getHistory()instanceof c&&this._persistentData.setHistory(new c);return this};h.CUSTOM_PROFILE_PROPERTIES_PREFIX="cu:";h.LOGIN_STATE_SIGNED_IN="signed_in";h.LOGIN_STATE_PREVIOUS_SESSION="previous_session";h.LOGIN_STATE_SIGNED_OUT="signed_out";h.LOGIN_STATE_UNKNOWN="unknown";
f.VisitorProfile=h})(econda||(econda={}));
(function(d){var f=d.storage||(d.storage={}),c=d.base.BaseClass,b=function(a){var e=c.call(this)||this;e._name=null;e._value=null;e._permanent=!1;e._pageViewsToLive=null;e._expires=null;e._invalidationAction=b.INVALIDATION_ACTION_REMOVE;e._isValid=!0;if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.setName=function(a){this._name=a;return this};b.prototype.getName=function(){return this._name};b.prototype.setValue=function(a){this._value=a;return this};b.prototype.getValue=
function(){return this._value};b.prototype.setPermanent=function(a){this._permanent=a;return this};b.prototype.getPermanent=function(){return this._permanent};b.prototype.setPageViewsToLive=function(a){this._pageViewsToLive=a;return this};b.prototype.getPageViewsToLive=function(){return this._pageViewsToLive};b.prototype.setExpires=function(a){this._expires=a;return this};b.prototype.getExpires=function(){return this._expires};b.prototype.setTtl=function(a){var b=new Date;b.setSeconds(b.getSeconds()+
a);this._expires=b;return this};b.prototype.setInvalidationAction=function(a){this._invalidationAction=a;return this};b.prototype.getInvalidationAction=function(){return this._invalidationAction};b.prototype.getIsValid=function(){return this._isValid};b.prototype._setIsValid=function(a){this._isValid=a;return this};b.prototype.getObjectData=function(){return{className:"econda.storage.Variable",data:{name:this._name,value:this._value,expires:this._expires,pageViewsToLive:this._pageViewsToLive,permanent:this._permanent,
invalidationAction:this._invalidationAction}}};b.prototype.setObjectData=function(a){this.set(a)};b.INVALIDATION_ACTION_REMOVE="remove";b.INVALIDATION_ACTION_KEEP="keep";f.Variable=b})(econda||(econda={}));
(function(d){var f=d.storage||(d.storage={}),c=d.storage.Variable,b=d.env.SessionStorage,a=d.env.LocalStorage,e=function(a){this._lastSaved=this._triggerSaveTimeout=null;this._name="default";this._autoSave=!0;this._variables={};this._variableStates={};if(a instanceof e)return a;"object"===typeof a&&null!==a&&("undefined"!==typeof a.name&&this.setName(a.name),"undefined"!==typeof a.autoSave&&this.setAutoSave(a.autoSave))};e.prototype.setName=function(a){this._name=a;return this};e.prototype.getName=
function(){return this._name};e.prototype.setAutoSave=function(a){this._autoSave=a;return this};e.prototype.getAutoSave=function(){return this._autoSave};e.prototype.getStorageKey=function(){return"econda.storage.ClientBag."+this._name};e.prototype.getAllVariables=function(){var a=[],b;for(b in this._variables)a.push(this._variables[b]);return a};e.prototype.get=function(a){return"undefined"===typeof this._variables[a]?null:this._variables[a]};e.prototype.getState=function(a){return"undefined"===
typeof this._variableStates[a]?null:this._variableStates[a]};e.prototype.set=function(a,b){void 0===b&&(b=!1);a=new c(a);if(!a.getName())throw"Cannot set variable. Name attribute is required but empty.";var e=a.getName();if(!0===b||"undefined"===typeof this._variables[e])this._variables[e]=a;this._variableStates[e]={added:new Date,pageViews:0};this._autoSave&&this._triggerSaveInBrowser();return this};e.prototype.update=function(a,b){var e=this.get(a);null!==e&&e.set(b);this._autoSave&&this._triggerSaveInBrowser();
return this};e.prototype._triggerSaveInBrowser=function(){var a=this;null!==this._triggerSaveTimeout&&clearTimeout(this._triggerSaveTimeout);this._triggerSaveTimeout=setTimeout(function(){a.saveInBrowser()},100)};e.prototype.saveInBrowser=function(){var e={state:{},variables:[]},c={state:{},variables:[]},f;for(f in this._variables){var i=this._variables[f];i.getPermanent()?(c.variables.push(i),"undefined"!==typeof this._variableStates[f]&&(c.state[f]=this._variableStates[f])):(e.variables.push(i),
"undefined"!==typeof this._variableStates[f]&&(e.state[f]=this._variableStates[f]))}f=new d.serialization.JsonSerializer;a.setItem(this.getStorageKey(),f.serialize(c));b.setItem(this.getStorageKey(),f.serialize(e));this._lastSaved=new Date;return this};e.prototype.loadFromBrowser=function(){var e,c,f=new d.serialization.JsonSerializer;c=a.getItem(this.getStorageKey());e=b.getItem(this.getStorageKey());if(c){var i=f.deserialize(c);"undefined"===typeof i.state&&(i.state={});for(c=0;c<i.variables.length;c++){var k=
i.variables[c].getName();this._variables[k]=i.variables[c];"object"===typeof i.state[k]&&null!==i.state[k]&&(this._variableStates[k]=i.state[k])}}if(e){e=f.deserialize(e);"undefined"===typeof e.state&&(e.state={});for(c=0;c<e.variables.length;c++)k=e.variables[c].getName(),this._variables[k]=e.variables[c],"object"===typeof e.state[k]&&null!==e.state[k]&&(this._variableStates[k]=e.state[k])}return this};e.prototype.init=function(){this.loadFromBrowser()._initVariablesAndState().saveInBrowser();return this};
e.prototype._initVariablesAndState=function(){for(var a in this._variables)this._updateVariableState(this._variables[a]);for(a in this._variableStates)"undefined"===typeof this._variables[a]&&delete this._variableStates[a];return this};e.prototype._updateVariableState=function(a){var b=a.getName(),e="undefined"!==typeof this._variableStates[b]?this._variableStates[b]:{added:new Date,pageViews:0};e.pageViews++;var c=!0,d=a.getPageViewsToLive(),c=c&&(null===d||e.pageViews<=d),a=a.getExpires(),c=c&&
(null===a||a>=new Date);!1===c&&this._invalidateVariable(b);return this};e.prototype._invalidateVariable=function(a){var b=this._variables[a];switch(b.getInvalidationAction()){case c.INVALIDATION_ACTION_REMOVE:this.destroy(a);break;case c.INVALIDATION_ACTION_KEEP:b._setIsValid(!1);break;default:throw"Invalid invalidation action.";}return this};e.prototype.destroy=function(a){delete this._variables[a];delete this._variableStates[a];return this};f.ClientBag=e})(econda||(econda={}));
(function(d){var f=d.env||(d.env={}),c=d.net.Uri,b=d.base.BaseClass,a=function(e){var c=b.call(this)||this;c._uri=null;c._timestamp=null;c._viewTime=null;if(e instanceof a)return e;c.initConfig(e);return c};__extends(a,b);a.prototype.getUri=function(){return this._uri};a.prototype.setUri=function(a){this._uri=new c(a);return this};a.prototype.getTimestamp=function(){return this._timestamp};a.prototype.setTimestamp=function(a){this._timestamp=a;return this};a.prototype.getViewTime=function(){return this._viewTime};
a.prototype.setViewTime=function(a){this._viewTime=a;return this};a.prototype.getObjectData=function(){return{className:"econda.env.PageView",data:{uri:this._uri?this._uri.toString():null,timestamp:this._timestamp,viewTime:this._viewTime}}};a.prototype.setObjectData=function(a){"object"===typeof a&&null!==a&&(this._uri=a.uri||null,this._timestamp=a.timestamp||null,this._viewTime=a.viewTime||null)};f.PageView=a})(econda||(econda={}));
(function(d){var f=d.env||(d.env={}),c=d.serialization.JsonSerializer,b=d.base.BaseClass,a=function(e){var c=b.call(this)||this;c._startDate=null;c._history=[];if(e instanceof a)return e;c.initConfig(e);return c};__extends(a,b);a.isSupported=function(){if("undefined"===typeof window.sessionStorage)return!1;var a=null;try{window.sessionStorage.setItem("ectest","ok"),a=window.sessionStorage.getItem("ectest")}finally{return"ok"==a}};a.prototype.getStartDate=function(){return this._startDate};a.prototype.getPageViewCount=
function(){return this.getHistory().length};a.prototype.getHistory=function(){return this._history};a.prototype.getObjectData=function(){return{className:"econda.env.Session",data:{startDate:this._startDate,history:this._history}}};a.prototype.setObjectData=function(a){this._startDate=a.startDate||null;this._history=a.history||[]};a.prototype.init=function(){this._loadFromSessionStorage();null===this._startDate&&this._initNewSession();this._addCurrentPageView();this._saveToSessionStorage()};a.prototype._initNewSession=
function(){this._startDate=new Date};a.prototype._loadFromSessionStorage=function(){var a=window.sessionStorage.getItem("econda.env.Session");return a?(c.deserialize(a,this),!0):!1};a.prototype._saveToSessionStorage=function(){window.sessionStorage.setItem("econda.env.Session",c.serialize(this))};a.prototype._addCurrentPageView=function(){var a=new d.env.PageView({timestamp:new Date,uri:document.location.href});this._history.push(a);return this};f.Session=a})(econda||(econda={}));
(function(d){var f=function(){};f.visitor=null;f.session=null;f.clientBag=null;d.data=f})(econda||(econda={}));econda.data.visitor=new econda.recengine.VisitorProfile;"object"===typeof econdaConfig&&("undefined"!==typeof econdaConfig.sessionStart&&econdaConfig.sessionStart&&econda.env.Session.isSupported())&&(econda.data.session=new econda.env.Session,econda.data.session.init());
"object"===typeof econdaConfig&&("undefined"!==typeof econdaConfig.clientBag&&!0===econdaConfig.clientBag)&&(econda.data.clientBag=(new econda.storage.ClientBag).init());
(function(d){var f=d.recengine||(d.recengine={}),f=f.context||(f.context={}),c=d.base.BaseClass,d=function(b){void 0===b&&(b=null);var a=c.call(this)||this;a.type="productcategory";a.id=null;a.variant=null;a.path=null;a.initConfig(b);return a};__extends(d,c);d.prototype.getType=function(){return this.type};d.prototype.setType=function(b){this.type=b;return this};d.prototype.getId=function(){return this.id};d.prototype.setId=function(b){this.id=b;return this};d.prototype.getVariant=function(){return this.variant};
d.prototype.setVariant=function(b){this.variant=b;return this};d.prototype.getPath=function(){return this.path};d.prototype.setPath=function(b){"string"==typeof b&&(b={path:b,delimiter:"/"});"object"==typeof b&&"undefined"!=typeof b.path&&("undefined"==typeof b.delimiter&&(b.delimiter="/"),b=b.path.split(b.delimiter));this.path=b;return this};f.CategoryReference=d})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.context||(f.context={}),c=d.recengine.context.CategoryReference,b=d.recengine.context.ProductReference,a=d.recengine.history.VisitorHistory,e=d.base.BaseClass,g=function(a){var b=e.call(this)||this;b.products=[];b.visitorHistory=null;b.categories=[];b.attributes={};b.profileProperties={};b.visitorId=null;b.customerId=null;b.recipientId=null;b.userId=null;b.email=null;b.emailHash=null;b.productsExcluded=[];b._appendVisitorData=null;a=a||{};if(a instanceof
g)return a;"undefined"!=typeof a.appendVisitorData&&(b._appendVisitorData=!0===a.appendVisitorData,delete a.appendVisitorData);b.initConfig(a);(!0===b._appendVisitorData||null===b._appendVisitorData&&("undefined"===typeof econdaConfig.crosssellAppendVisitorData||!0===econdaConfig.crosssellAppendVisitorData))&&b._doAppendVisitorData();return b};__extends(g,e);g.prototype.getProducts=function(){return this.products};g.prototype.setProducts=function(a){this.products=[];this.addProducts(a);return this};
g.prototype.addProducts=function(a){return this.addArray("products",a,b,{itemFilter:this._productReferenceInputFilter})};g.prototype.addProduct=function(a){return this.addProducts(a)};g.prototype.getVisitorHistory=function(){return this.visitorHistory};g.prototype.setVisitorHistory=function(b){this.visitorHistory=new a(b)};g.prototype.getCategories=function(){return this.categories};g.prototype.setCategories=function(a){return this.setArray("categories",a,c)};g.prototype.addCategories=function(a){return this.addArray("categories",
a,c)};g.prototype.addCategory=function(a){return this.addCategories(a)};g.prototype.getAttributes=function(){return this.attributes};g.prototype.setAttributes=function(a,b){void 0===b&&(b=null);this.attributes={};return this.addAttributes(a,b)};g.prototype.addAttributes=function(a,b){void 0===b&&(b=null);if("string"==typeof a)this.attributes[a]=b;else for(var e in a)this.attributes[e]=a[e];return this};g.prototype.setProfileProperties=function(a){this.profileProperties=a};g.prototype.getProfileProperties=
function(){return this.profileProperties};g.prototype.setVisitorId=function(a){this.visitorId=a;return this};g.prototype.getVisitorId=function(){return this.visitorId};g.prototype.setCustomerId=function(a){this.customerId=a;return this};g.prototype.getCustomerId=function(){return this.customerId};g.prototype.setRecipientId=function(a){this.recipientId=a;return this};g.prototype.getRecipientId=function(){return this.recipientId};g.prototype.setUserId=function(a){this.userId=a;return this};g.prototype.getUserId=
function(){return this.userId};g.prototype.setEmail=function(a){this.email=a;return this};g.prototype.getEmail=function(){return this.email};g.prototype.setEmailHash=function(a){this.emailHash=a;return this};g.prototype.getEmailHash=function(){return this.emailHash};g.prototype.getProductsExcluded=function(){return this.productsExcluded};g.prototype.setProductsExcluded=function(a){return this.setArray("productsExcluded",a,b,{itemFilter:this._productReferenceInputFilter})};g.prototype.addProductsExcluded=
function(a){return this.addArray("productsExcluded",a,b,{itemFilter:this._productReferenceInputFilter})};g.prototype._productReferenceInputFilter=function(a){return a instanceof b?a:{id:a.id||null,sku:a.sku||null}};g.prototype._doAppendVisitorData=function(){try{var a=d.data.visitor;this.setVisitorId(a.getVisitorId());this.setCustomerId(a.getCustomerId());this.setUserId(a.getUserId());this.setRecipientId(a.getRecipientId());this.setEmail(a.getEmail());this.setEmailHash(a.getEmailHash());this.setProfileProperties(a.getProperties());
this.setVisitorHistory(a.getHistory())}catch(b){d.debug.error("Could not append visitor profile data to cross sell request due to an internal exception: "+b)}};f.Context=g})(econda||(econda={}));
(function(d){var d=d.util||(d.util={}),f=function(){};f.isDate=function(c){return"[object Date]"==Object.prototype.toString.call(c)};f.toUtcIsoString=function(c){function b(a){return 10>a?"0"+a:""+a}return c instanceof Date?c.getUTCFullYear()+"-"+b(c.getUTCMonth()+1)+"-"+b(c.getUTCDate())+"T"+b(c.getUTCHours())+":"+b(c.getUTCMinutes())+":"+b(c.getUTCSeconds())+"Z":null};d.DateUtils=f})(econda||(econda={}));
(function(d){var d=d.env||(d.env={}),f=function(){};f.getUserAgent=function(){null==this.userAgent&&(this.userAgent=window.navigator.userAgent);return this.userAgent};f.getName=function(){null==this._name&&this.init();return this._name};f.getVersion=function(){null==this._version&&this.init();return this._version};f.isMobile=function(){null==this._isMobile&&this.init();return this._isMobile};f.init=function(){this.initNameAndVersion();this.initIsMobile()};f.initIsMobile=function(){this._isMobile=
null!=navigator.userAgent.match(/mobile/i)};f.initNameAndVersion=function(){var c=this.getUserAgent();null==this._name&&/;\s*MSIE\s+(\d+\.\d+)*/.test(c)&&(this._name=this.INTERNET_EXPLORER,this._version=+RegExp.$1);null==this._name&&/Firefox\s*\/\s*(\d+\.\d+)*/.test(c)&&(this._name=this.FIREFOX,this._version=+RegExp.$1);null==this._name&&/Chrome\s*\/\s*(\d+\.\d+)*/.test(c)&&(this._name=this.CHROME,this._version=+RegExp.$1);null==this._name&&/Version\s*\/\s*(\d+\.\d+)*.*Safari/.test(c)&&(this._name=
this.SAFARI,this._version=+RegExp.$1)};f.INTERNET_EXPLORER="internet explorer";f.CHROME="chrome";f.FIREFOX="firefox";f.SAFARI="safari";f.userAgent=null;f._name=null;f._version=null;f._isMobile=null;d.UserAgent=f})(econda||(econda={}));(function(d){(d.ajax||(d.ajax={})).Response=function(){this.isError=this.responseText=this.status=null}})(econda||(econda={}));
(function(d){var f=d.ajax||(d.ajax={}),f=f.writer||(f.writer={}),c=d.base.BaseClass,b=function(){var a=null!==c&&c.apply(this,arguments)||this;a._data=null;return a};__extends(b,c);b.prototype.setData=function(a){this._data=a;return this};b.prototype.getHeaders=function(){return{"Content-Type":"application/json; charset=UTF-8"}};b.prototype.getBody=function(){return d.util.Json.stringify(this._data)};f.JsonWriter=b})(econda||(econda={}));
(function(d){var f=d.ajax||(d.ajax={}),f=f.writer||(f.writer={}),c=d.base.BaseClass,b=function(){var a=null!==c&&c.apply(this,arguments)||this;a._data=null;return a};__extends(b,c);b.prototype.setData=function(a){this._data=a;return this};b.prototype.getHeaders=function(){return{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};b.prototype.getBody=function(){var a=[],b=this._data,c;for(c in b)if(d.util.ArrayUtils.isArray(b[c]))for(var f=0;f<b[c].length;f++)a.push(c+"="+encodeURIComponent(b[c][f]));
else a.push(c+"="+encodeURIComponent(b[c]));return a.join("&")};f.FormEncodedWriter=b})(econda||(econda={}));(function(d){var f=d.ajax||(d.ajax={}),f=f.reader||(f.reader={}),c=function(){};c.prototype.read=function(b){var a=null;if(b)try{a=d.util.Json.parse(b)}catch(e){a=null}return a};f.JsonReader=c})(econda||(econda={}));
(function(d){var f=d.ajax||(d.ajax={}),f=f.transport||(f.transport={}),c=d.ajax.Response,b=function(){this._initialized=!1;this._allHeaders={}};b.prototype.setRequest=function(a){this._request=a};b.prototype.getRequest=function(){return this._request};b.prototype.hasHeaders=function(){if(Object.keys)return 0<Object.keys(this._allHeaders).length;var a=[],b;for(b in this._allHeaders)Object.prototype.hasOwnProperty.call(this._allHeaders,b)&&a.push(b);return 0<a.length};b.prototype.init=function(){this.initWriterInstance();
this.initXmlHttpRequestInstance();this.appendCallbacks();this._xhr.open("POST",this.getRequestUriWithParams(),!0);this._request.isXDomainRequest()&&(this._request.getWithCredentials()&&this._xhr instanceof XMLHttpRequest)&&(this._xhr.withCredentials=!0);this.appendHeaders();this._initialized=!0};b.prototype.send=function(){var a=this;this._initialized||this.init();setTimeout(function(){a._xhr.send(a.getEncodedRequestData());var b=a._request.getAfterSend();b&&b()},20)};b.prototype.initWriterInstance=
function(){var a=this._request.getData(),b=this._request.getWriter();null==b&&a&&"object"==typeof a&&(b=new d.ajax.writer.FormEncodedWriter);b&&(b.setData(this._request.getData()),this._writer=b)};b.prototype.appendHeaders=function(){var a={"Content-Type":"text/plain"};!1==this._request.isXDomainRequest()&&(a["X-Requested-With"]="XMLHttpRequest");if(this._writer){var b=this._writer.getHeaders();if(b)for(var c in b)a[c]=b[c]}if(b=this._request.getHeaders())for(c in b)a[c]=b[c];this._allHeaders=a;if("undefined"!=
typeof this._xhr.setRequestHeader)for(c in a)this._xhr.setRequestHeader(c,a[c]);return this};b.prototype.getEncodedRequestData=function(){var a="";return a=this._writer?this._writer.getBody():""+this._request.getData()};b.prototype.isSupportedRequest=function(){this.initXmlHttpRequestInstance();var a=this._request.isXDomainRequest();return a=(a=(a=!1==a||!1==this._isOldIE())&&!1==this.hasHeaders()||"undefined"!=typeof this._xhr.setRequestHeader&&!1==this._isOldIE())&&(!1==this._request.getWithCredentials()||
this._xhr instanceof XMLHttpRequest)};b.prototype._isOldIE=function(){var a=d.env.UserAgent;return a.getName()!=a.INTERNET_EXPLORER||8<=a.getVersion()?!1:!0};b.prototype.initXmlHttpRequestInstance=function(){var a=this._request.isXDomainRequest();this._xhr||(this._xhr=a&&"undefined"!=typeof window.XDomainRequest?new window.XDomainRequest:"undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"));this._xhr.timeout=this._request.getTimeoutMilliseconds()};b.prototype.getRequestUriWithParams=
function(){var a=this._request.getUri(),b=this._request.getParams();return a.clone().appendParams(b).toString()};b.prototype.appendCallbacks=function(){var a=this;this._xhr.onreadystatechange=function(){a.onReadyStateChange.apply(a,arguments)};return this};b.prototype.onReadyStateChange=function(){var a=this._xhr,b=this._request;if(4==a.readyState){var d=new c;d.responseText=a.responseText;d.status=a.status;d.isError=200!=a.status;b.handleResponse(d)}};f.Post=b})(econda||(econda={}));
(function(d){var f=d.ajax||(d.ajax={}),f=f.transport||(f.transport={}),c=d.ajax.Response,d=function(){this._initialized=!1;this._allHeaders={}};d.prototype.setRequest=function(b){this._request=b};d.prototype.getRequest=function(){return this._request};d.prototype.isSupportedRequest=function(){return!0};d.prototype.hasHeaders=function(){if(Object.keys)return 0<Object.keys(this._allHeaders).length;var b=[],a;for(a in this._allHeaders)Object.prototype.hasOwnProperty.call(this._allHeaders,a)&&b.push(a);
return 0<b.length};d.prototype.init=function(){var b=this;this._xhr=this.createXmlHttpRequestInstance();this._xhr.onreadystatechange=function(){b.onReadyStateChange.apply(b,arguments)};this._xhr.open("GET",this.getRequestUriWithParams(),!0);this.appendHeaders();this._initialized=!0};d.prototype.appendHeaders=function(){var b={"Content-Type":"text/plain"};!1==this._request.isXDomainRequest()&&(b["X-Requested-With"]="XMLHttpRequest");var a=this._request.getHeaders();if(a)for(var e in a)b[e]=a[e];this._allHeaders=
b;if("undefined"!=typeof this._xhr.setRequestHeader)for(e in b)this._xhr.setRequestHeader(e,b[e]);return this};d.prototype.send=function(b){var a=this;"undefined"!=typeof b&&this.setRequest(b);this._initialized||this.init();setTimeout(function(){a._xhr.send()},20)};d.prototype.createXmlHttpRequestInstance=function(){var b=null;return b="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")};d.prototype.getRequestUriWithParams=function(){var b=this._request.getUri(),
a=this._request.getParams();return b.clone().appendParams(a).toString()};d.prototype.onReadyStateChange=function(){var b=this._xhr,a=this._request;if(4==b.readyState){var e=new c;e.responseText=b.responseText;e.status=b.status;e.isError=200!=b.status;a.handleResponse(e)}};f.Get=d})(econda||(econda={}));
(function(d){var f=d.ajax||(d.ajax={}),f=f.transport||(f.transport={}),c=d.ajax.Response,b=d.net.Uri,a=function(){this._instanceIndex=this._request=this._iframe=null;this._state=0;this._instanceIndex=a._instanceCount++};a.setBlankUri=function(a){econdaConfig.blankUri=new b(a)};a.getBlankUri=function(){if("undefined"!=typeof econdaConfig){var e=econdaConfig;if("undefined"!=typeof e.blankUri)return new b(e.blankUri)}return new b(a.defaultBlankUri)};a.prototype.setRequest=function(a){this._request=a};
a.prototype.init=function(){};a.prototype.send=function(){var a=this._request.getUri(),a=a.appendParams({windowname:"true"}),a=a.appendParams(this._request.getParams());this.setupIFrame();d.debug.log("Sending request using window.name transport to uri: "+a);this.navigateIFrameToTarget(a)};a.prototype.isSupportedRequest=function(){return!0};a.prototype.navigateIFrameToTarget=function(b){this._iframe.contentWindow.location.href=b.toString();this._state=a.STATE_LOADING};a.prototype.navigateIFrameToOwnHost=
function(){this._iframe.contentWindow.location.href=a.getBlankUri().toString()};a.prototype.handleOnLoad=function(){switch(this._state){case a.STATE_LOADING:this._state=a.STATE_LOADED;this.navigateIFrameToOwnHost();break;case a.STATE_LOADED:var b=new c;try{b.responseText=this._iframe.contentWindow.name,b.status=200,b.isError=!1}catch(g){d.debug.error("Could not read content from iframe for request to "+this._request.getUri().toString(),{exception:g,iframe:this._iframe}),b.responseText="",b.status=
0,b.isError=!0}this._request.handleResponse(b);this.removeIFrame()}};a.prototype.removeIFrame=function(){this._iframe.parentElement.removeChild(this._iframe)};a.prototype.setupIFrame=function(){var b=this,c=document.getElementsByTagName("body")[0],d;d=document.createElement("iframe");d.style.display="none";d.style.width="1px";d.style.height="1px";var f=function(){b.handleOnLoad.apply(b,arguments)};"function"===typeof d.attachEvent?d.attachEvent("onload",f):d.onload=f;c.appendChild(d);this._iframe=
d;this._state=a.STATE_INITIALIZED};a.defaultBlankUri="/favicon.ico";a._instanceCount=0;a.STATE_UNINITIALIZED=0;a.STATE_INITIALIZED=1;a.STATE_LOADING=2;a.STATE_LOADED=3;f.WindowName=a})(econda||(econda={}));
(function(d){var f=d.ajax||(d.ajax={}),c=d.env.UserAgent,b=d.net.Uri,a=d.base.BaseClass,e=function(b){var c=a.call(this)||this;c._uri=null;c._method="get";c._params=null;c._headers={};c._data=null;c._writer=null;c._reader=null;c._success=null;c._error=null;c._callback=null;c._afterSend=null;c.timeoutMilliseconds=0;c._withCredentials=!1;c._transport=null;c._inititalized=!1;if(b instanceof e)return b;c.initConfig(b);return c};__extends(e,a);e.prototype.getUri=function(){return this._uri};e.prototype.setUri=
function(a){this._uri=new b(a);return this};e.prototype.getMethod=function(){return this._method};e.prototype.setMethod=function(a){this._method=a.toLocaleLowerCase();return this};e.prototype.getParams=function(){return this._params};e.prototype.setParams=function(a){this._params=a;return this};e.prototype.addParams=function(a,b){void 0===b&&(b=null);if("string"==typeof a)this._params[a]=b;else for(var e in a)this._params[e]=a[e];return this};e.prototype.getHeaders=function(){return this._headers};
e.prototype.setHeaders=function(a,b){this._headers={};return this.addHeaders.apply(this,arguments)};e.prototype.addHeaders=function(a,b){if("string"==typeof a)this._headers[a]=b;else for(var e in a)this._headers[e]=a[e];return this};e.prototype.hasHeaders=function(){if(Object.keys)return 0<Object.keys(this._headers).length;for(var a in this._headers)if(Object.prototype.hasOwnProperty.call(this._headers,a))return!0;return!1};e.prototype.getData=function(){return this._data};e.prototype.setData=function(a){this._data=
a;return this};e.prototype.getWriter=function(){return this._writer};e.prototype.setWriter=function(a){if("string"==typeof a)switch(a){case "form-encoded":this._writer=new d.ajax.writer.FormEncodedWriter;break;case "json":this._writer=new d.ajax.writer.JsonWriter;break;default:throw"Unsupported writer: "+a;}else this._writer=a;return this};e.prototype.getReader=function(){return this._reader};e.prototype.setReader=function(a){if("string"==typeof a)switch(a){case "json":this._reader=new d.ajax.reader.JsonReader;
break;default:throw"Unsupported response reader: "+a;}else this._reader=a;return this};e.prototype.getSuccess=function(){return this._success};e.prototype.setSuccess=function(a){this._success=a;return this};e.prototype.getError=function(){return this._error};e.prototype.setError=function(a){this._error=a;return this};e.prototype.getCallback=function(){return this._callback};e.prototype.setCallback=function(a){this._callback=a;return this};e.prototype.getAfterSend=function(){return this._afterSend};
e.prototype.setAfterSend=function(a){this._afterSend=a;return this};e.prototype.getTimeoutMilliseconds=function(){return this.timeoutMilliseconds};e.prototype.setTimeoutMilliseconds=function(a){this.timeoutMilliseconds=a;return this};e.prototype.setWithCredentials=function(a){this._withCredentials=a;return this};e.prototype.getWithCredentials=function(){return this._withCredentials};e.prototype.setTransport=function(a){if("string"===typeof a)switch(a.toLowerCase()){case "post":this._transport=new d.ajax.transport.Post;
break;case "get":this._transport=new d.ajax.transport.Get;break;case "windowname":this._transport=new d.ajax.transport.WindowName;break;default:throw Error("unknown transport: "+a);}else this._transport=a;this._transport.setRequest(this);return this};e.prototype.getTransport=function(){return this._transport};e.prototype.init=function(){null==this.getUri()&&d.debug.error("Trying to send request, but request has empty uri.");this._transport||this.autoDetectAndSetTransport();this._transport.init();
this._inititalized=!0};e.prototype.send=function(){!1==this._inititalized&&this.init();this._transport.send(this)};e.prototype.handleResponse=function(a){var b=this.getReader();a.data=b?b.read(a.responseText):a.responseText;a.isError?this._error&&this._error.call(this,a):this._success&&this._success.apply(this,[a.data]);this._callback&&this._callback.call(this,a)};e.prototype.autoDetectAndSetTransport=function(){if(!this._transport){var a;switch(this._method){case "get":a=this.isXDomainRequest()&&
c.getName()==c.INTERNET_EXPLORER&&10>c.getVersion()?new d.ajax.transport.WindowName:new d.ajax.transport.Get;break;case "post":a=new d.ajax.transport.Post;break;default:throw"Unsupported request method: "+this._method;}this.setTransport(a)}};e.prototype.isSupportedRequest=function(){this._transport||this.autoDetectAndSetTransport();return this._transport.isSupportedRequest()};e.prototype.isXDomainRequest=function(){var a=!1,b=this._uri.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i);(b=b&&b[1])&&
b!=location.host&&(a=!0);return a};f.Request=e})(econda||(econda={}));(function(d){var d=d.ajax||(d.ajax={}),d=d.reader||(d.reader={}),f=function(){};f.prototype.read=function(c){return c};d.TextReader=f})(econda||(econda={}));(function(d){var f=d.ajax||(d.ajax={}),c=function(){};c.createRequest=function(b){return new d.ajax.Request(b)};c.request=function(b){b=this.createRequest(b);b.send();return b};f.Ajax=c})(econda||(econda={}));econda.Ajax=econda.ajax.Ajax;
(function(d){var f=d.recengine||(d.recengine={}),f=f.proxy||(f.proxy={}),c=d.recengine.response.Response,b=d.recengine.event.ProductAddToCartEvent,a=d.recengine.event.ProductBuyEvent,e=d.recengine.event.ProductViewEvent,g=d.util.DateUtils,j=d.base.BaseClass,h=function(a){void 0===a&&(a=null);var b=j.call(this)||this;b.uri=null;b.request=null;b._ajaxRequest=null;if(a instanceof h)return a;b.initConfig(a);return b};__extends(h,j);h.prototype.getUri=function(){return this.uri};h.prototype.setUri=function(a){this.uri=
a};h.prototype.setRequest=function(a){this.request=a};h.prototype.getRequest=function(){return this.request};h.prototype.getAjaxRequest=function(){return this._ajaxRequest};h.detectProtocol=function(){return"string"===typeof location.protocol&&"https:"===location.protocol?"https":"http"};h.prototype._isCookieRequired=function(){var a;return a=this.request.getAutoContext()};h.prototype.send=function(){var a=this.request,b=this,e=h.detectProtocol(),c=this.uri;c||(c=[e,"://widgets.crosssell.info/eps/crosssell/recommendations/",
a.getAccountId(),".do"].join(""));var e=this.getRecommendationServiceFormFieldParametersFromRequest(),f=this._ajaxRequest=d.ajax.Ajax.createRequest({uri:c,method:"post",writer:"form-encoded",reader:"json",data:e,withCredentials:b._isCookieRequired(),timeoutMilliseconds:a.getTimeoutMilliseconds(),success:function(a){b.handleSuccess(a)},error:function(){b.handleError()}});f.init();f.isSupportedRequest()||(f=this._ajaxRequest=d.ajax.Ajax.createRequest({uri:c,method:"get",reader:"json",params:e,withCredentials:b._isCookieRequired(),
timeoutMilliseconds:a.getTimeoutMilliseconds(),success:function(a){b.handleSuccess(a)},error:function(){b.handleError()}}));f.send()};h.prototype.handleError=function(){var a=new c({isError:!0});this.request.handleResponse(a)};h.prototype.handleSuccess=function(a){a?("undefined"===typeof a.products&&(a.products=a.items||[],delete a.items),"undefined"!==typeof a.widgetdetails&&(a.widgetDetails=a.widgetdetails,delete a.widgetdetails),"undefined"!==typeof a.start&&(a.startIndex=a.start,delete a.start),
"undefined"!==typeof a.end&&(a.endIndex=a.end,delete a.end),delete a.size,a=new c(a),a.setRequest(this.getRequest()),this.request.handleResponse(a)):this.handleError()};h.prototype.getRecommendationServiceFormFieldParametersFromRequest=function(){var c=this.request,f={};f.wid=c.getWidgetId();f.aid=c.getAccountId();f.type=c.getType();f.start=c.getStartIndex();f.widgetdetails=!0;var g=c.getChunkSize();g&&(f.csize=g);g=[];c.getAutoContext()&&(g=this._getAutoContextParamValue());if(c=c.getContext()){for(var h=
c.getProducts(),j=0;j<h.length;j++)h[j].getSku()?g.push("sku:"+h[j].getSku()):g.push(h[j].getId());h=c.getCategories();if(0<h.length)for(j=0;j<h.length;j++){var n=h[j],p="ctxcat";0<j&&(p+=j);f[p+".ct"]=n.getType();n.getId()&&(f[p+".cid"]=n.getId());n.getPath()&&(f[p+".paa"]=n.getPath());n.getVariant()&&(f[p+".pv"]=n.getVariant())}var h=c.getAttributes(),l;for(l in h)switch(h[l]){case null:f["ctxcustom."+l]="";break;default:f["ctxcustom."+l]=""+h[l]}c.getVisitorId()&&(f.emvid=c.getVisitorId());c.getCustomerId()&&
(f.emcid=c.getCustomerId());c.getRecipientId()&&(f.emrid=c.getRecipientId());c.getUserId()&&(f.emuid=c.getUserId());c.getEmail()&&(f.ememail=c.getEmail());c.getEmailHash()&&(f.ememailhash=c.getEmailHash());l=c.getProfileProperties();for(var m in l)l.hasOwnProperty(m)&&(f["p."+m]=l[m]);m=d.data.visitor.getHistory();f["p.ec:productBasketAddList"]=this._convertProductEventListToJsonParamValue(m.getFilteredItems(function(a){return a instanceof b}));f["p.ec:productBuyList"]=this._convertProductEventListToJsonParamValue(m.getFilteredItems(function(b){return b instanceof
a}));f["p.ec:productViewList"]=this._convertProductEventListToJsonParamValue(m.getFilteredItems(function(a){return a instanceof e}));f.timestamp=this._currentDateAsUtcIsoString();m=c.getProductsExcluded();f.excl=this._convertProductReferencesListToParamValue(m)}f.pid=g;return f};h.prototype._getAutoContextParamValue=function(){for(var a=[],b=d.data.visitor.getHistory().getFilteredItems(function(a){return a instanceof e}),c,f=0;f<b.length;f++)if(c=b[f].getProduct())c.getSku()?a.push("sku:"+c.getSku()):
a.push(c.getId());return a.slice(-5).reverse()};h.prototype._currentDateAsUtcIsoString=function(){return g.toUtcIsoString(new Date)};h.prototype._convertProductEventListToJsonParamValue=function(a){for(var b=[],e=0;e<a.length;e++){var c;if(c=a[e].getProduct())null!==c.getSku()?b.push({t:g.toUtcIsoString(a[e].getTimestamp()),sku:c.getSku()}):b.push({t:g.toUtcIsoString(a[e].getTimestamp()),pid:c.getId()})}a=b.reverse();return d.util.Json.stringify(a)};h.prototype._convertProductReferencesListToParamValue=
function(a,b){for(var e=[],c="function"===typeof b?b:function(a){return a},d=0;d<a.length;d++){var f=c(a[d]);null!==f.getSku()?e.push("sku:"+f.getSku()):e.push(f.getId())}return e};f.AjaxProxy=h})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),c=d.recengine.context.Context,b=d.base.BaseClass,a=function(e){void 0===e&&(e=null);var c=b.call(this)||this;c.widgetId=null;c.accountId=null;c.startIndex=0;c.chunkSize=null;c.context=null;c.defaultContextEnabled=!0;c.autoContext=!1;c.type=a.TYPE_CROSS_SELL;c.decorators=[];c.proxy=null;c.success=null;c._error=null;c.timeoutMilliseconds=0;c._callback=null;c.requestWasSuccessful=null;if(e instanceof a)return e;c.initConfig(e);return c};__extends(a,b);
a.prototype.getWidgetId=function(){return this.widgetId};a.prototype.setWidgetId=function(a){this.widgetId=a;return this};a.prototype.getAccountId=function(){return this.accountId||econdaConfig.crosssellAccountId};a.prototype.setAccountId=function(a){this.accountId=a;return this};a.prototype.getStartIndex=function(){return this.startIndex};a.prototype.setStartIndex=function(a){this.startIndex=a;return this};a.prototype.getChunkSize=function(){return this.chunkSize};a.prototype.setChunkSize=function(a){this.chunkSize=
a;return this};a.prototype.getContext=function(){return this.defaultContextEnabled?this.context||new c:this.context};a.prototype.setContext=function(a){this.context=new c(a);return this};a.prototype.getDefaultContextEnabled=function(){return this.defaultContextEnabled};a.prototype.setDefaultContextEnabled=function(a){this.defaultContextEnabled=!0===a};a.prototype.getAutoContext=function(){return this.autoContext};a.prototype.setAutoContext=function(a){this.autoContext=a;return this};a.prototype.getType=
function(){return this.type};a.prototype.setType=function(b){b!==a.TYPE_CROSS_SELL&&b!==a.TYPE_AD_REQUEST&&d.debug.error("Trying to set invalid cross sell request type: "+b);this.type=b;return this};a.prototype.getDecorators=function(){return this.decorators};a.prototype.setDecorators=function(a){var b=this;return this.setArray("decorators",a,null,{callback:function(a){a.setRequest(b)}})};a.prototype.addDecorators=function(a){var b=this;return this.addArray("decorators",a,null,{callback:function(a){a.setRequest(b)}})};
a.prototype.getProxy=function(){return this.proxy};a.prototype.setProxy=function(a){if("string"===typeof a){var b=d.util.StringUtils.ucFirst(a);if("undefined"!==typeof d.recengine.proxy[b])this.proxy=new d.recengine.proxy[b];else throw"proxy not supported: "+a;}else this.proxy=a;this.proxy&&"undefined"!==typeof this.proxy.setRequest&&this.proxy.setRequest(this);return this};a.prototype.getSuccess=function(){return this.success};a.prototype.setSuccess=function(a){this.success=a;return this};a.prototype.getError=
function(){return this._error};a.prototype.setError=function(a){this._error=a;return this};a.prototype.getTimeoutMilliseconds=function(){return this.timeoutMilliseconds};a.prototype.setTimeoutMilliseconds=function(a){this.timeoutMilliseconds=a;return this};a.prototype.getCallback=function(){return this._callback};a.prototype.setCallback=function(a){this._callback=a;return this};a.prototype.send=function(){var a=this.proxy;a||(a=new d.recengine.proxy.AjaxProxy,a.setRequest(this));this._validateAndLogErrors();
a.send()};a.prototype.getRecommendationServiceParameters=function(){var a=this.proxy;a||(a=new d.recengine.proxy.AjaxProxy,a.setRequest(this));return a.getRecommendationServiceFormFieldParametersFromRequest()};a.prototype._validateAndLogErrors=function(){this.getAccountId()||d.debug.error("Missing crosssell account id in request.",this);this.getWidgetId()||d.debug.error("Missing widget id in request",this)};a.prototype.handleResponse=function(a){a.getIsError()?"function"===typeof this._error&&this._error():
(this.processResponseDecorators(a),"function"===typeof this.success&&this.success(a));"function"===typeof this._callback&&this._callback(a)};a.prototype.processResponseDecorators=function(a){var b=a.getWidgetDetails();if((b=b&&b.getTracking())&&!0===b.getEmcs()){var c="",f=this.getContext();f&&0<f.getProducts().length&&(c=f.getProducts()[0].getId());this.addDecorators(new d.recengine.decorator.PerformanceTracking({position:b.getEmcs1(),source:c,widgetName:b.getEmcs0()}))}for(b=0;b<this.decorators.length;b++)this.decorators[b].decorate(a)};
a.TYPE_CROSS_SELL="cs";a.TYPE_AD_REQUEST="ac";f.Request=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.widget||(f.widget={}),f=f.renderer||(f.renderer={}),c=d.base.BaseClass,b=function(a){void 0===a&&(a=null);var e=c.call(this)||this;e.widget=null;e.rendererFn=null;e.scope=null;if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.getWidget=function(){return this.widget};b.prototype.setWidget=function(a){this.widget=a};b.prototype.getRendererFn=function(){return this.rendererFn};b.prototype.setRendererFn=function(a){this.rendererFn=
a;return this};b.prototype.getScope=function(){return this.scope};b.prototype.setScope=function(a){this.scope=a;return this};b.prototype.render=function(a){if(!this.rendererFn)throw"Widget FunctionRenderer requires a renderer function to be set. No renderer function found. Check widget.renderer.rendererFn.";var b=d.util.DomHelper.element(this.getWidget().getElement());return this.rendererFn.call(this.scope||this,a,b,d.util.StringUtils)};f.FunctionRenderer=b})(econda||(econda={}));
(function(d){var f=d.templating||(d.templating={}),c=d.net.Uri,b=d.util.DomHelper,a=d.base.BaseClass,e=function(b){var c=a.call(this)||this;c._engineInstance=null;c.uri=null;c.template=null;c.engine="ejs";c._element=null;if(b instanceof e)return b;c.initConfig(b,"uri");return c};__extends(e,a);e.prototype.getUri=function(){return this.uri};e.prototype.setUri=function(a){this.uri=new c(a);return this};e.prototype.getTemplate=function(){return this.template};e.prototype.setTemplate=function(a){this.template=
a;return this};e.prototype.getEngine=function(){return this.engine};e.prototype.setEngine=function(a){a=a.toLowerCase();if("ejs"!=a)throw"It's not possible to change the template engine in this version.";return this};e.prototype.getElement=function(){return this._element};e.prototype.setElement=function(a){this._element=a;return this};e.prototype.render=function(a){void 0===a&&(a=null);var b=this.getUri(),c=this.getTemplate(),e=this.getElement();!b&&(!c&&!e)&&d.debug.error("Cannot render template: No template or uri found.");
e&&(e=this._readTemplateSourceFromDom(e))&&(c=e);null==this._engineInstance&&("undefined"==typeof EJS&&d.debug.error("EJS is undefined. Make sure EJS is included from lib directory."),this._engineInstance=new EJS({url:b?b.toString():null,text:c}));return this._engineInstance.render(a)};e.prototype._readTemplateSourceFromDom=function(a){var a=b.element(a),c=null;if(!a)return null;for(var c=a.innerHTML,e=0;e<a.childNodes.length;e++)if(8==a.childNodes[e].nodeType){c=a.childNodes[e].textContent;break}return c.trim().replace("&lt;%",
"<%").replace("%&gt;","%>")};f.Template=e})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.widget||(f.widget={}),f=f.renderer||(f.renderer={}),c=d.net.Uri,b=d.base.BaseClass,a=function(c){var d=b.call(this)||this;d._widget=null;d._uri=null;d._template=null;if(c instanceof a)return c;d.initConfig(c);return d};__extends(a,b);a.prototype.setWidget=function(a){this._widget=a};a.prototype.setUri=function(a){this._uri=null==a?null:new c(a);return this};a.prototype.getUri=function(){return this._uri};a.prototype.getTemplate=function(){return this._template};
a.prototype.setTemplate=function(a){this._template=a;return this};a.prototype.getElement=function(){return this._element};a.prototype.setElement=function(a){this._element=a;return this};a.prototype.render=function(a){var b=this.getUri(),c=this.getTemplate(),f=this.getElement(),b=new d.templating.Template({uri:b,template:c,element:f});try{return b.render(a)}catch(i){(a=this._widget.getError())&&a()}};f.TemplateRenderer=a})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.widget||(f.widget={}),f=f.renderer||(f.renderer={}),c=d.base.BaseClass,b=function(a){void 0===a&&(a=null);var e=c.call(this)||this;e.widget=null;e.template="econda.htm";e.callback=null;if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.getWidget=function(){return this.widget};b.prototype.setWidget=function(a){this.widget=a};b.prototype.getTemplate=function(){return this.template};b.prototype.setTemplate=function(a){this.template=
a;return this};b.prototype.getCallback=function(){return this.callback};b.prototype.setCallback=function(a){this.callback=a;return this};b.prototype.render=function(a){var b=d.util.DomHelper.element(this.getWidget().getElement()),c=this.getTemplate(),f=this.getCallback();null!=f&&f(b,a,c);return!1};f.WebsaleRenderer=b})(econda||(econda={}));
(function(d){var f=d.condition||(d.condition={}),c=d.base.BaseClass,b=function(a){var e=c.call(this)||this;e._conditions=[];if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.areTrue=function(){for(var a=0,b=this._conditions.length;a<b;a++)if(!1===this._conditions[a].isTrue())return!1;return!0};b.prototype.add=function(a){this.addArray("_conditions",a);return this};b.prototype.clear=function(){this._conditions=[];return this};f.ConditionContainer=b})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.widget||(f.widget={}),c=d.base.BaseClass,b=function(a){var e=c.call(this)||this;e._widget=null;e._template=null;e._image=null;if(a instanceof b)return a;if(a instanceof d.net.Uri)return e._constructWithConfigString(a.toString()),e;if("string"==typeof a)return e._constructWithConfigString(a),e;"object"==typeof a&&null!==a&&e._constructWithConfigObject(a);return e};__extends(b,c);b.prototype.setWidget=function(a){this._widget=a};b.prototype.getWidget=
function(){return this._widget};b.prototype.getTemplate=function(){return this._template};b.prototype.setTemplate=function(a){this._template="string"==typeof a?a.match(/\.html?/i)?{uri:a}:{template:a}:a;return this};b.prototype.getImage=function(){return this._image};b.prototype.setImage=function(a){this._image=null===a?null:new d.net.Uri(a);return this};b.prototype._constructWithConfigObject=function(a){if(a.id||a.widgetId)this._widget=a;else if(a.uri||a.template)this._template=a};b.prototype._constructWithConfigString=
function(a){a.match(/\.html?/i)?this._template={uri:a}:a.match(/\.(png|jpg|jpeg|gif)/i)?this._image=new d.net.Uri(a):this._template={template:a}};f.FallbackConfig=b})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.widget||(f.widget={}),c=d.base.BaseClass,b=function(a){var e=c.call(this)||this;e._element=null;e._config=null;e._allowCrossSellRequests=!0;e._callback=null;if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.getElement=function(){return this._element};b.prototype.setElement=function(a){this._element=a;return this};b.prototype.getConfig=function(){return this._config};b.prototype.setConfig=function(a){this._config=a;
return this};b.prototype.getAllowCrossSellRequests=function(){return this._allowCrossSellRequests};b.prototype.setAllowCrossSellRequests=function(a){this._allowCrossSellRequests=a;return this};b.prototype.getCallback=function(){return this._callback};b.prototype.setCallback=function(a){this._callback=a;return this};b.prototype.execute=function(){this._tryRenderFallbackWidget()};b.prototype._tryRenderFallbackWidget=function(){var a=this,b=this._config;null!==b.getWidget()&&this._allowCrossSellRequests?
(b=b.getWidget(),b=new d.recengine.Widget(b),b.setElement(this.getElement()),b.setAfterRender(function(b,c){!1===c?a._tryRenderFallbackTemplate():a._exitStatusSuccess()}),b.render()):this._tryRenderFallbackTemplate()};b.prototype._tryRenderFallbackTemplate=function(){var a=this._config;null!==a.getTemplate()?(a=a.getTemplate(),a=(new d.templating.Template(a)).render(),d.util.DomHelper.update(this.getElement(),a),this._exitStatusSuccess()):this._tryRenderFallbackImage()};b.prototype._tryRenderFallbackImage=
function(){var a;if(null!==this._config.getImage()&&(a=this.getElement())){d.util.DomHelper.empty(a);var b=document.createElement("img");b.src=this._config.getImage().toString();a.appendChild(b);this._exitStatusSuccess()}else this._exitStatusFailure()};b.prototype._exitStatusSuccess=function(){"function"==typeof this._callback&&this._callback({success:!0})};b.prototype._exitStatusFailure=function(){"function"==typeof this._callback&&this._callback({success:!1})};f.FallbackHandler=b})(econda||(econda=
{}));
(function(d){var f=d.recengine||(d.recengine={}),c,b=f.Request,a=function(c){var f=b.call(this)||this;f.element=null;f.removeIfEmpty=!1;f.empty=null;f.setEmpty=function(a){this.empty=a;return this};f.emptyThreshold=null;f.renderer=null;f.afterRender=null;f._preConditions=new d.condition.ConditionContainer;f._fallback=null;if(c instanceof a)return c;f.initConfig(c);return f};__extends(a,b);a.prototype.getId=function(){return this.getWidgetId()};a.prototype.setId=function(a){this.setWidgetId(a);return this};
a.prototype.getElement=function(){return this.element};a.prototype.setElement=function(a){this.element=a;return this};a.prototype.getRemoveIfEmpty=function(){return this.removeIfEmpty};a.prototype.setRemoveIfEmpty=function(a){this.removeIfEmpty=a;return this};a.prototype.getEmpty=function(){return this.empty};a.prototype.getEmptyThreshold=function(){return null!=this.emptyThreshold?this.emptyThreshold:this.chunkSize};a.prototype.setEmptyThreshold=function(a){this.emptyThreshold=a;return this};a.prototype.getRenderer=
function(){return this.renderer};a.prototype.setRenderer=function(a){if("string"==typeof a)return this.renderer=this.createAndReturnRenderer(a),this;if(a&&a.type)return this.renderer=this.createAndReturnRenderer(a.type,a),this;this.renderer=a;return this};a.prototype.setAfterRender=function(a){this.afterRender=a;return this};a.prototype.getAfterRender=function(){return this.afterRender};a.prototype.setPreConditions=function(a){this._preConditions.clear();this.addPreConditions(a);return this};a.prototype.addPreConditions=
function(a){if(d.util.ArrayUtils.isArray(a))for(var b=0;b<a.length;b++)this._preConditions.add(a[b]);else this._preConditions.add(a);return this};a.prototype.setFallback=function(a){this._fallback=new d.recengine.widget.FallbackConfig(a);return this};a.prototype.getFallback=function(){return this._fallback};a.prototype.createAndReturnRenderer=function(a,b){void 0===b&&(b=null);var c=d.util.StringUtils.ucFirst(a)+"Renderer";if("undefined"==typeof d.recengine.widget.renderer[c])throw"Unknown renderer type: "+
a;"undefined"!=typeof b.type&&delete b.type;return new d.recengine.widget.renderer[c](b)};a.prototype.send=function(){b.prototype.send.call(this)};a.prototype.render=function(){return this.send()};a.prototype.handleResponse=function(a){b.prototype.handleResponse.call(this,a);!0===a.getIsError()?this._onErrorResponse(a):a.products.length<this.getEmptyThreshold()?this._onEmptyResponse(a):this._onSuccessfulResponse(a)};a.prototype._onSuccessfulResponse=function(a){this.requestWasSuccessful=!0;if(this.renderer){var b=
null;this.renderer.setWidget(this);b=this.renderer.render(a);!1!==b&&d.util.DomHelper.update(this.element,b);"function"==typeof this.afterRender&&this.afterRender.call(this,this.requestWasSuccessful)}};a.prototype._onErrorResponse=function(){var a=this;this.requestWasSuccessful=!1;this._executeFallback(!1,function(){"function"==typeof this.afterRender&&a.afterRender.call(a,a.requestWasSuccessful)})};a.prototype._onEmptyResponse=function(a){var b=this;this.requestWasSuccessful=!1;var c=function(){"function"==
typeof b.afterRender&&b.afterRender.call(b,b.requestWasSuccessful);"function"==typeof b.empty&&b.empty.call(b,a)};this.removeIfEmpty?(d.util.DomHelper.remove(this.element),"function"==typeof this.empty&&this.empty.call(this,a)):this._executeFallback(!0,c)};a.prototype._executeFallback=function(a,b){void 0===a&&(a=!0);void 0===b&&(b=null);null!==this._fallback?(new d.recengine.widget.FallbackHandler({config:this._fallback,element:this.element,allowCrossSellRequests:a,callback:b})).execute():"function"==
typeof b&&b({success:!1})};a.renderWidgetsFromConfigArray=function(b){for(var c=0;c<b.length;c++)(new a(b[c])).render()};c=a;f.Widget=c;f=function(){"undefined"!=typeof ecWidgets&&c.renderWidgetsFromConfigArray(ecWidgets)};d.util.DomHelper.isDocumentReady()?f():d.util.DomHelper.documentReady(f)})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),f=f.proxy||(f.proxy={}),c=d.recengine.proxy.AjaxProxy,b=function(){return null!==c&&c.apply(this,arguments)||this};__extends(b,c);b.prototype._getClientId=function(){var a=this.getRequest().getAccountId();return null==a||10>a.length?(d.debug.error("Invalid account id in cross sell request: "+a),null):a.substr(0,8)};b.prototype._getRequestUri=function(){var a=this.getRequest().getAccountId(),b=c.detectProtocol(),d=this._getClientId();return b+"://cross.econda-monitor.de/l/"+
d+"/"+a+".do"};b.prototype._isCookieRequired=function(){return!0};b.prototype.send=function(){if(null==this.getUri()){var a=this._getRequestUri();this.setUri(a)}c.prototype.send.call(this)};f.AdProxy=b})(econda||(econda={}));
(function(d){var f=d.recengine||(d.recengine={}),c=f.Widget,b=function(a){void 0===a&&(a=null);var b=c.call(this)||this;b.setType("ac");b.setDefaultContextEnabled(!1);b.initConfig(a);b.setProxy(new d.recengine.proxy.AdProxy);return b};__extends(b,c);b.renderAdWidgetsFromConfigArray=function(a){for(var c=0;c<a.length;c++)(new b(a[c])).render()};f.AdWidget=b;f=function(){"undefined"!=typeof ecAdWidgets&&b.renderAdWidgetsFromConfigArray(ecAdWidgets)};d.util.DomHelper.isDocumentReady()?f():d.util.DomHelper.documentReady(f)})(econda||
(econda={}));(function(d){var f=d.recengine||(d.recengine={}),c=f.Request,b=function(a){void 0===a&&(a=null);var e=c.call(this)||this;if(a instanceof b)return a;e.setType(f.Request.TYPE_AD_REQUEST);e.setDefaultContextEnabled(!1);e.initConfig(a);e.setProxy(new d.recengine.proxy.AdProxy);return e};__extends(b,c);f.AdRequest=b})(econda||(econda={}));
(function(d){var f=d.profileaccess||(d.profileaccess={}),f=f.context||(f.context={}),c=d.base.BaseClass,b=function(a){var e=c.call(this)||this;e.profileProperties={};e.visitorId=null;e.customerId=null;e.recipientId=null;e.userId=null;e.email=null;e.emailHash=null;e._appendVisitorData=null;a=a||{};if(a instanceof b)return a;"undefined"!=typeof a.appendVisitorData&&(e._appendVisitorData=!0===a.appendVisitorData,delete a.appendVisitorData);e.initConfig(a);!0===e._appendVisitorData&&e._doAppendVisitorData();
return e};__extends(b,c);b.prototype.setProfileProperties=function(a){this.profileProperties=a};b.prototype.getProfileProperties=function(){return this.profileProperties};b.prototype.setVisitorId=function(a){this.visitorId=a;return this};b.prototype.getVisitorId=function(){return this.visitorId};b.prototype.setCustomerId=function(a){this.customerId=a;return this};b.prototype.getCustomerId=function(){return this.customerId};b.prototype.setRecipientId=function(a){this.recipientId=a;return this};b.prototype.getRecipientId=
function(){return this.recipientId};b.prototype.setUserId=function(a){this.userId=a;return this};b.prototype.getUserId=function(){return this.userId};b.prototype.setEmail=function(a){this.email=a;return this};b.prototype.getEmail=function(){return this.email};b.prototype.setEmailHash=function(a){this.emailHash=a;return this};b.prototype.getEmailHash=function(){return this.emailHash};b.prototype._doAppendVisitorData=function(){try{var a=d.data.visitor;this.setVisitorId(a.getVisitorId());this.setCustomerId(a.getCustomerId());
this.setUserId(a.getUserId());this.setRecipientId(a.getRecipientId());this.setEmail(a.getEmail());this.setEmailHash(a.getEmailHash());this.setProfileProperties(a.getProperties())}catch(b){d.debug.error("Could not append visitor profile data to cross sell request due to an internal exception: "+b)}};f.Context=b})(econda||(econda={}));
(function(d){var f=d.profileaccess||(d.profileaccess={}),c=d.profileaccess.context.Context,b=d.base.BaseClass,a=function(c){void 0===c&&(c=null);var d=b.call(this)||this;d.endpointKey=null;d.accountId=null;d.context=null;d.defaultContextEnabled=!0;d.proxy=null;d.success=null;d._error=null;d._callback=null;d.requestWasSuccessful=null;if(c instanceof a)return c;d.initConfig(c);return d};__extends(a,b);a.prototype.getEndpointKey=function(){return this.endpointKey};a.prototype.setEndpointKey=function(a){this.endpointKey=
a;return this};a.prototype.getAccountId=function(){return this.accountId||econdaConfig.crosssellAccountId};a.prototype.setAccountId=function(a){this.accountId=a;return this};a.prototype.getContext=function(){return this.defaultContextEnabled?this.context||new c:this.context};a.prototype.setContext=function(a){this.context=new c(a);return this};a.prototype.getDefaultContextEnabled=function(){return this.defaultContextEnabled};a.prototype.setDefaultContextEnabled=function(a){this.defaultContextEnabled=
!0===a};a.prototype.getProxy=function(){return this.proxy};a.prototype.setProxy=function(a){if("string"===typeof a){var b=d.util.StringUtils.ucFirst(a);if("undefined"!==typeof d.profileaccess.proxy[b])this.proxy=new d.profileaccess.proxy[b];else throw"proxy not supported: "+a;}else this.proxy=a;this.proxy&&"undefined"!==typeof this.proxy.setRequest&&this.proxy.setRequest(this);return this};a.prototype.getSuccess=function(){return this.success};a.prototype.setSuccess=function(a){this.success=a;return this};
a.prototype.getError=function(){return this._error};a.prototype.setError=function(a){this._error=a;return this};a.prototype.getCallback=function(){return this._callback};a.prototype.setCallback=function(a){this._callback=a;return this};a.prototype.send=function(){var a=this.proxy;a||(a=new d.profileaccess.proxy.AjaxProxy,a.setRequest(this));this._validateAndLogErrors();a.send()};a.prototype._validateAndLogErrors=function(){this.getAccountId()||d.debug.error("Missing crosssell account id in request.",
this);this.getEndpointKey()||d.debug.error("Missing endpoint key in request",this)};a.prototype.handleResponse=function(a){a.isError?"function"===typeof this._error&&this._error(a):"function"===typeof this.success&&this.success(a);"function"===typeof this._callback&&this._callback(a)};f.Request=a})(econda||(econda={}));
(function(d){var f=d.profileaccess||(d.profileaccess={}),f=f.proxy||(f.proxy={}),c=d.base.BaseClass,b=function(a){void 0===a&&(a=null);var e=c.call(this)||this;e.uri=null;e.serviceUri=null;e.request=null;e._ajaxRequest=null;if(a instanceof b)return a;e.initConfig(a);return e};__extends(b,c);b.prototype.getUri=function(){return this.uri};b.prototype.setUri=function(a){this.uri=a};b.prototype.getServiceUri=function(){return this.serviceUri};b.prototype.setServiceUri=function(a){this.serviceUri=a};b.prototype.setRequest=
function(a){this.request=a};b.prototype.getRequest=function(){return this.request};b.prototype.getAjaxRequest=function(){return this._ajaxRequest};b.prototype.send=function(){var a=this,b=this.uri;b||(b=this.getEndpointUri());var c=this.getEndpointParameters(),f=this.getHeaderValues();(this._ajaxRequest=d.ajax.Ajax.createRequest({uri:b,method:"get",reader:"json",params:c,headers:f,success:function(b){a.handleSuccess(b)},error:function(b){a.handleError(b)}})).send()};b.prototype.getEndpointUri=function(){var a=
this.uri,b=this.request;if(!a){var a=d.net.Uri.detectProtocol(),c=this.getServiceUri();c||(c="services.crosssell.info/profileaccess");a=[a,"://",c,"/",b.getAccountId(),"/profiles/",b.getEndpointKey()].join("")}return a};b.prototype.handleError=function(a){if(!a||!a.isError)a={isError:!0};this.request.handleResponse(a)};b.prototype.handleSuccess=function(a){a?this.request.handleResponse(a):this.handleError(null)};b.prototype.getEndpointParameters=function(){return{}};b.prototype.getHeaderValues=function(){return{}};
f.AjaxProxy=b})(econda||(econda={}));
(function(d){var f=d.profileaccess||(d.profileaccess={}),f=f.proxy||(f.proxy={}),c=d.profileaccess.proxy.AjaxProxy,d=function(){return null!==c&&c.apply(this,arguments)||this};__extends(d,c);d.prototype.getEndpointParameters=function(){var b={},a=this.getRequest().getContext();a&&(a.getVisitorId()&&(b.emvid=a.getVisitorId()),a.getCustomerId()&&(b.emcid=a.getCustomerId()),a.getRecipientId()&&(b.emrid=a.getRecipientId()),a.getUserId()&&(b.emuid=a.getUserId()),a.getEmail()&&(b.ememail=a.getEmail()),
a.getEmailHash()&&(b.ememailhash=a.getEmailHash()));return b};f.PublicEndpointProxy=d})(econda||(econda={}));(function(d){var f=d.profileaccess||(d.profileaccess={}),c=f.Request,b=function(a){void 0===a&&(a=null);var e=c.call(this)||this;if(a instanceof b)return a;e.initConfig(a);e.getProxy()||e.setProxy(new d.profileaccess.proxy.PublicEndpointProxy);return e};__extends(b,c);f.PublicEndpointRequest=b})(econda||(econda={}));
(function(d){var f=d.profileaccess||(d.profileaccess={}),f=f.proxy||(f.proxy={}),c=d.profileaccess.proxy.AjaxProxy,d=function(){return null!==c&&c.apply(this,arguments)||this};__extends(d,c);d.prototype.getHeaderValues=function(){var b={},a=this.getRequest();a.getWebToken()&&(b["X-AUTH-TOKEN"]=a.getWebToken());return b};f.WebtokenEndpointProxy=d})(econda||(econda={}));
(function(d){var f=d.profileaccess||(d.profileaccess={}),c=f.Request,b=function(a){void 0===a&&(a=null);var e=c.call(this)||this;e.webToken=null;if(a instanceof b)return a;e.initConfig(a);e.getProxy()||e.setProxy(new d.profileaccess.proxy.WebtokenEndpointProxy);return e};__extends(b,c);b.prototype.getWebToken=function(){return this.webToken};b.prototype.setWebToken=function(a){this.webToken=a;return this};b.prototype._validateAndLogErrors=function(){c.prototype._validateAndLogErrors.call(this);this.getWebToken()||
d.debug.error("Missing webtoken in request",this)};f.WebTokenEndpointRequest=b})(econda||(econda={}));
(function(d){var f=d.tracking||(d.tracking={}),c=d.tracking.PluginManager,b=function(){};b.getInstance=function(){null===b._instance&&(b._instance=new b);return b._instance};b.prototype.onRequest=function(a,b){d.debug.log("Tracking request",a,b)};b.enable=function(){c.registerPlugin(b.getInstance())};b.disable=function(){c.unregisterPlugin(b.getInstance())};b._instance=null;f.DebugLogger=b;("undefined"!==typeof econdaConfig.trackingLogRequests&&!0==econdaConfig.trackingLogRequests||"undefined"===
typeof econdaConfig.trackingLogRequests&&!0==econdaConfig.debug)&&b.enable()})(econda||(econda={}));
(function(d){var f=d.tracking||(d.tracking={}),c=d.cookie.Store,b=d.tracking.VisitorId,a=function(){};a.prototype.onAfterRequest=function(c,f){var j=this;f.isTrackThirdParty()&&!f.doNotTrack()&&!f.isSyncCacheId()?this.requestThirdPartyVisitorId(function(a){"string"===typeof a&&6<a.length&&b.update(a,{domain:f.getCookieDomain(),expires:f.getClientCookieLifetime()});j.disableAndMarkSessionUpdated()}):d.tracking.PluginManager.unregisterPlugin(a)};a.prototype.disableAndMarkSessionUpdated=function(){d.tracking.PluginManager.unregisterPlugin(a);
c.set({name:"ec_vid_updated",value:"1"})};a.prototype.requestThirdPartyVisitorId=function(a){try{var b=new XMLHttpRequest;b.withCredentials=!0;b.open("GET",this.buildServiceURL(),!0);b.onreadystatechange=function(){200==b.status&&a(b.responseText)};b.send()}catch(c){}};a.prototype.buildServiceURL=function(){return d.net.Uri.detectProtocol()+"://cross.econda-monitor.de/vi"};f.ThirdPartyVisitorIdPlugIn=a;"1"!==c.getValue("ec_vid_updated")&&d.tracking.PluginManager.registerPlugin(new a)})(econda||(econda=
{}));
